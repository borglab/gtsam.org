{"version":1,"kind":"Article","sha256":"ac678393b34850de061165261c3be0db0d373cf977e14294f4ab392bfbd2cfd4","slug":"content.blogs.2020.2020-08-30-laplacian","location":"/Content/Blogs/2020/2020-08-30-Laplacian.md","dependencies":[],"frontmatter":{"title":"Mount Rainier's Eigenvectors","github":"https://github.com/borglab/gtsam","numbering":{"title":{"offset":2}},"edit_url":"https://github.com/borglab/gtsam/blob/docs/ktk-sdk/Content/Blogs/2020/2020-08-30-Laplacian.md","thumbnail":"/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"md","filename":"2020-08-30-Laplacian.md","url":"/2020-08-30-Laplacian-9b1ac7d321ebd032198ea3d48a6ae71d.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://dellaert.github.io","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Frank Dellaert","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"JTuh6TeRHq"}],"urlSource":"https://dellaert.github.io","key":"uZVndAFuDO"},{"type":"text","value":", August 30, 2020","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HF2MfnEMsg"}],"identifier":"frank-dellaert-august-30-2020","label":"Frank Dellaert, August 30, 2020","html_id":"frank-dellaert-august-30-2020","implicit":true,"key":"QxPoFvWjRQ"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"In this post I’ll talk a bit about estimating absolute quantities from relative measurements, using the reconstruction of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Cb1M3Q94Q1"},{"type":"link","url":"https://en.wikipedia.org/wiki/Mount_Rainier","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Mount Rainier","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"JwYNPodEFb"}],"urlSource":"https://en.wikipedia.org/wiki/Mount_Rainier","data":{"page":"Mount_Rainier","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"EkuDeRKrjX"},{"type":"text","value":" as a motivating example. I’ll show how the Hessian of that problem is exactly the “Graph Laplacian” from graph theory, and relate the eigen-decomposition of that graph with the properties of the reconstruction.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DwiuClZoKj"}],"key":"xNsf7SMVKf"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"There is an accompaning ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"dlpaGJlwfp"},{"type":"link","url":"https://www.youtube.com/watch?v=-U00XjFLQag","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Youtube video","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HqjzRZ9R6G"}],"urlSource":"https://www.youtube.com/watch?v=-U00XjFLQag","key":"SPwMYs8JL1"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"D4X7wQvaDp"}],"key":"AvJKXwymX9"},{"type":"div","children":[{"type":"text","value":"Also, this post was created as a Colab notebook, and you can run it yourself here: ","key":"GcY5zgq8oF"},{"type":"link","url":"https://colab.research.google.com/github/borglab/gtsam.org/blob/master/notebooks/Laplacian.ipynb","children":[{"type":"image","url":"/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","key":"sUVtFBliZ1","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/borglab/gtsam.org/blob/master/notebooks/Laplacian.ipynb","key":"qXuD1bdq6V"}],"key":"fhxEjLDzZZ"},{"type":"code","lang":"","value":"#@Libraries we need\nimport networkx as nx\nimport matplotlib.pyplot as plt\nfrom matplotlib import image\nfrom mpl_toolkits.mplot3d import Axes3D\n%matplotlib inline\nimport numpy as np\nimport scipy\nfrom sklearn.neighbors import NearestNeighbors","position":{"start":{"line":16,"column":1},"end":{"line":26,"column":1}},"key":"BtMqSONdDm"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Reconstructing Mount Rainier","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"pHBtU3zQAP"}],"identifier":"reconstructing-mount-rainier","label":"Reconstructing Mount Rainier","html_id":"reconstructing-mount-rainier","implicit":true,"key":"aBolj5JjbH"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Imagine you and your friends have climbed Mount Rainier, and you were able to obtain a large number of ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ZnHavsWdP6"},{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"relative","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ZIYUhOZqEB"}],"key":"iF8kecejC7"},{"type":"text","value":" height measurements: can we reconstruct the shape of the mountain from those? It turns out the answer is yes, modulo an unknown height offset.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"oZYKJgrcWU"}],"key":"s4Skp30YQV"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"To simulate this scenario, I will use a ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"LgSJolxfrQ"},{"type":"link","url":"https://en.wikipedia.org/wiki/Digital_elevation_model","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Digital Elevation Model (DEM)","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"lab8bTHisg"}],"urlSource":"https://en.wikipedia.org/wiki/Digital_elevation_model","data":{"page":"Digital_elevation_model","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"Wf410k1tKb"},{"type":"text","value":". It’s not super-easy to get one’s hands on digital elevation data, but luckily ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Ao84mcCeGn"},{"type":"link","url":"https://mattbooty.wordpress.com/2019/01/20/3d-printing-a-model-of-mount-rainier-using-digital-elevation-model-dem-files/","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Matt Booty has done it for us","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ju6hTyCWd5"}],"urlSource":"https://mattbooty.wordpress.com/2019/01/20/3d-printing-a-model-of-mount-rainier-using-digital-elevation-model-dem-files/","key":"pYOxrStYoo"},{"type":"text","value":" for Mount Rainier. Below we download the image and load it into this notebook.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"kDjKBR6qDs"}],"key":"vxs4SWFMKg"},{"type":"code","lang":"","value":"!wget -q https://mattbooty.files.wordpress.com/2019/01/mr-dem-height-map-output-03.jpg\ndem = image.imread('mr-dem-height-map-output-03.jpg')\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(dem);","position":{"start":{"line":35,"column":1},"end":{"line":40,"column":1}},"key":"QDTigiInpY"},{"type":"image","url":"/Laplacian_3_0-3c4de72278e4ab89d1755c31c45c0a87.png","alt":"png","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"xC17WD1Njl","urlSource":"/_static/Laplacian//Laplacian_3_0.png"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"First, we’ll get some sample points, corresponding to where you and your friends would have taken measurements. In this example we assume we know the 2D locations of the points, although it is not hard to extend the example beyond that assumption.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"ESJ6KJlGET"}],"key":"m7CIldi63m"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"The code below samples 500 different locations and shows them on the DEM:","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"HfamNb2zuK"}],"key":"PnIsELNRRb"},{"type":"code","lang":"","value":"coordinates = np.random.multivariate_normal(mean=[420,800], cov=100*100*np.eye(2),size=500)\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(dem);\nax.scatter(coordinates[:,0], coordinates[:,1], marker='.')\nplt.show()","position":{"start":{"line":51,"column":1},"end":{"line":57,"column":1}},"key":"DB39aSozDV"},{"type":"image","url":"/Laplacian_5_0-47a99923f2718e263e572c0cb52bf6ea.png","alt":"png","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"ab6p5CeLiK","urlSource":"/_static/Laplacian//Laplacian_5_0.png"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"Let’s collect all 2D and their associated ground-truth heights into a numpy array, filtering out samples from the black border.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"xQK5vjwiIY"}],"key":"ZFGLWNKnim"},{"type":"code","lang":"","value":"truth = np.array([(x,y,dem[y,x,0]) for x,y in np.round(coordinates).astype(np.int) if dem[y,x,0]>0])\nN = truth.shape[0]\nz = truth[:,2]","position":{"start":{"line":66,"column":1},"end":{"line":70,"column":1}},"key":"Dz4dyRzczr"},{"type":"paragraph","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"To create relative measurements, we’ll use a graph derived from the K-nearest neighbors.","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"nwj74U4z2q"}],"key":"Wp5W7E3asg"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"The associated estimation problem is quite simple, and we can see it as a factor graph with just pairwise linear factors ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"WBv5TQF8Mn"},{"type":"inlineMath","value":"\\|z_i -z_j - \\delta_{ij}\\|^2","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>z</mi><mi>j</mi></msub><mo>−</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\|z_i -z_j - \\delta_{ij}\\|^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1002em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"svtuvr3q18"},{"type":"text","value":". In this linear case, the factor graph is completely equivalent to a sparse rectangular matrix ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"rqiSy65z7A"},{"type":"inlineMath","value":"H","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"t4g8vD3egM"},{"type":"text","value":", with entries 1 and -1. For every edge ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"oy03jpEgec"},{"type":"inlineMath","value":"(i,j)","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>","key":"Amy2FJGZd4"},{"type":"text","value":" in the nearest neighbor graph, there is one row/factor.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"W66HVZrPAT"}],"key":"QAzjN45DvL"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"From the graph ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"UuUHK8mrnG"},{"type":"inlineMath","value":"G","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"a5m5NbhVtM"},{"type":"text","value":" we can easily generate this sparse measurement matrix ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"uZ1hVRK942"},{"type":"inlineMath","value":"H","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"az6RPsbtcW"},{"type":"text","value":" using the (oriented) ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"JSylDZfSkt"},{"type":"inlineCode","value":"incidence_matrix","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"zya3heKOh1"},{"type":"text","value":" function in ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"OmYDtkRB98"},{"type":"inlineCode","value":"networkx","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"n6vI5Yeuit"},{"type":"text","value":". The relative measurements ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"r5fcrichfq"},{"type":"inlineMath","value":"d","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"EqKJA3po3u"},{"type":"text","value":" are then obtained as ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"r4WPuC3Y0j"},{"type":"inlineMath","value":"d=H z","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><mi>H</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">d=H z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Hz</span></span></span></span>","key":"CevoOSeCCO"},{"type":"text","value":" where ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"hhfc5HpFnr"},{"type":"inlineMath","value":"z","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"PWUPXmXimv"},{"type":"text","value":" are the ground truth height values.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"JaB3zcbADB"}],"key":"KJ7wjtSvMP"},{"type":"code","lang":"","value":"# Find nearest Neighbors\nneigh = NearestNeighbors(n_neighbors=6, radius=100)\nneigh.fit(truth)\nA = neigh.kneighbors_graph()","position":{"start":{"line":79,"column":1},"end":{"line":84,"column":1}},"key":"Uez4ZGwUtE"},{"type":"code","lang":"","value":"# Create graph\nG0 = nx.from_scipy_sparse_matrix(A)\n\n# Create measurement matrix H\nH = nx.incidence_matrix(G0, oriented=True).transpose()\nM, N = H.shape\n\n# Simulate measurements d\nd = H @ z + np.random.normal(size=(M,),scale=1)\nplt.hist(d);","position":{"start":{"line":87,"column":1},"end":{"line":98,"column":1}},"key":"n6oowmcGTn"},{"type":"image","url":"/Laplacian_10_0-58b30d9df85621cc738a0c7210fb6618.png","alt":"png","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"K3DgJ95XZ5","urlSource":"/_static/Laplacian//Laplacian_10_0.png"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Unfortunately relative measurements alone can never tell us about absolute height. To remedy this we add one row to ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"pv1OPD13GT"},{"type":"inlineMath","value":"H","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"fWZg89cQ7K"},{"type":"text","value":" to clamp ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"zEk1yFJFam"},{"type":"inlineMath","value":"\\hat{z}[0]","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>z</mi><mo>^</mo></mover><mo stretchy=\"false\">[</mo><mn>0</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\hat{z}[0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mclose\">]</span></span></span></span>","key":"ezjTcjWL7M"},{"type":"text","value":" to ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"njfrwzCFkY"},{"type":"text","value":"100","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"ormAZZu4j9"},{"type":"text","value":", and we then use the ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"kGSsm2JUTM"},{"type":"inlineCode","value":"lsqr","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"XV0ZykvL6a"},{"type":"text","value":" method in scipy to obtain estimated heights ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"OzmMLiUGqJ"},{"type":"inlineMath","value":"\\hat{z}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>z</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"WV25LeoK7y"},{"type":"text","value":":","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"ayjQJEEUQO"}],"key":"kj4G1st42c"},{"type":"code","lang":"","value":"H1 = scipy.sparse.bmat([[H], [scipy.sparse.eye(1,N)]])\nd1 = np.concatenate((d,[truth[0,2]]))\nz, istop, itn, r1norm = scipy.sparse.linalg.lsqr(H1, d1)[:4]","position":{"start":{"line":108,"column":1},"end":{"line":112,"column":1}},"key":"fApVVCKsl6"},{"type":"paragraph","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Finally, let’s render the result in 3D:","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"I0CAS6Bowo"}],"key":"Jw5IbRUPWU"},{"type":"code","lang":"","value":"fig = plt.figure(figsize=(12,8))\nax = fig.add_subplot(111, projection='3d')\nax.scatter(truth[:,0], truth[:,1], z, marker='.');","position":{"start":{"line":117,"column":1},"end":{"line":121,"column":1}},"key":"zYiaxjVXfO"},{"type":"image","url":"/Laplacian_14_0-23de7760acf51e6edba66c44168e3f21.png","alt":"png","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"G5Pu399Zj1","urlSource":"/_static/Laplacian//Laplacian_14_0.png"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"That does not look half-bad ;-)","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"C5xiWxryAY"}],"key":"gIEiBPlRxp"},{"type":"heading","depth":2,"position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Of Jacobians, Hessians, and Graph Laplacians","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"kGCCllGNA6"}],"identifier":"of-jacobians-hessians-and-graph-laplacians","label":"Of Jacobians, Hessians, and Graph Laplacians","html_id":"of-jacobians-hessians-and-graph-laplacians","implicit":true,"key":"NeExOUki2L"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"The large (but sparse) measurement matrix ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"R0lch4q6mh"},{"type":"inlineMath","value":"H","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"gUN9QWHbgt"},{"type":"text","value":" we used above is also called the ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"mVPoTKM0JL"},{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Jacobian","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"VKR1YpALM2"}],"key":"BJVsZ0tJYr"},{"type":"text","value":", and the ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"dR3bBfwdeq"},{"type":"inlineCode","value":"lsqr","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"cF0owrf89a"},{"type":"text","value":" method solved the linear least-squares problem ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"OkbHmbrG3u"},{"type":"inlineMath","value":"\\hat{z} = \\arg\\min_z \\|H z - d \\|^2","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>z</mi><mo>^</mo></mover><mo>=</mo><mi>arg</mi><mo>⁡</mo><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>z</mi></msub><mi mathvariant=\"normal\">∥</mi><mi>H</mi><mi>z</mi><mo>−</mo><mi>d</mi><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\hat{z} = \\arg\\min_z \\|H z - d \\|^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">ar<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop\">min</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Hz</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"eiF4xSJ4DV"},{"type":"text","value":". This is really just a multivariate quadratic with its curvature given by the ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"mAAx0ymD6Y"},{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Hessian","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"GspmXv9VyW"}],"key":"Ofg0QbQZCN"},{"type":"text","value":" ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"fC1qGP8yrr"},{"type":"inlineMath","value":"Q\\doteq H^TH","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><mo>≐</mo><msup><mi>H</mi><mi>T</mi></msup><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">Q\\doteq H^TH</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≐</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"ZT2DkNRv37"},{"type":"text","value":". The Hessian is also known as the ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"GcHDOIHpvu"},{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"information matrix","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"hP35k53TWH"}],"key":"VX3FLxIVYF"},{"type":"text","value":", and is equal to the inverse of the ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"GDtGITAxoR"},{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"covariance matrix","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"MGsJ3W0Ax5"}],"key":"nsLUTj6NHF"},{"type":"text","value":" ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"XHfJ1hgn8I"},{"type":"inlineMath","value":"P\\doteq Q^{-1}","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo>≐</mo><msup><mi>Q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">P\\doteq Q^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≐</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ggjiJgsGf0"},{"type":"text","value":".","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"SwEqFfdYen"}],"key":"pHiQ7IIc8m"},{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"The significance of all this that the Hessian ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"A15VLEN4rV"},{"type":"inlineMath","value":"Q","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"EBWZwJgD64"},{"type":"text","value":" tells us exactly ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"rUb27U7pPW"},{"type":"emphasis","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"how much we know","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"DuZQYRpaTM"}],"key":"NNjud3ryfT"},{"type":"text","value":" about the estimated heights given the measurements and the uncertainty associated with the measurements (which here we silently assumed to be zero-mean Gaussian additive noise with unit standard deviation ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"QZ40TqlJqN"},{"type":"inlineMath","value":"\\sigma=1","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\sigma=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"i0MFrX787p"},{"type":"text","value":").","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"iE7R77MoXc"}],"key":"oi0CtzlqDf"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"To explore this in a bit more depth, let’s simplify the problem even more and only consider 1D mountains. Below we walk up a mountain and record  relative height measurements between 6 subsequent points:","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"ZV5eXvIB1C"}],"key":"oxVwMj89oG"},{"type":"code","lang":"","value":"z = np.array([100,120,130,120,110,110])\nplt.plot(z,'-*');","position":{"start":{"line":138,"column":1},"end":{"line":141,"column":1}},"key":"l2u7CZjVtM"},{"type":"image","url":"/Laplacian_18_0-72704dad0b2ed70a56d76594253fe605.png","alt":"png","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"q6zWfQhUKi","urlSource":"/_static/Laplacian//Laplacian_18_0.png"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"Let us take measurements both between neighboring points as well as points one hop away, which should intuitively improve our estimates:","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"WkW14b3y1r"}],"key":"HEOC4Yqu1V"},{"type":"code","lang":"","value":"G = nx.Graph()\nG.add_edges_from([(0,1),(0,2),(1,2),(1,3),(2,3),(2,4),(3,4),(3,5),(4,5)])\nH = nx.incidence_matrix(G, oriented=True).transpose()\nM, N = H.shape\nd = H @ z + np.random.normal(size=(M,),scale=1)","position":{"start":{"line":150,"column":1},"end":{"line":156,"column":1}},"key":"WZnJMEEheO"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"If we calculate at the Hessian ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"LUIfSz8RNw"},{"type":"inlineMath","value":"Q=H^T H","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><mo>=</mo><msup><mi>H</mi><mi>T</mi></msup><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">Q=H^T H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"kvbgCWxaoO"},{"type":"text","value":" for this simpler problem, we see that it is a ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"dwN3ib1RQD"},{"type":"inlineMath","value":"6\\times 6","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6\\times 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"yPQs8iQkun"},{"type":"text","value":" matrix:","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"S1TUoIMhbO"}],"key":"RnX1eEm5uI"},{"type":"code","lang":"","value":"Q = H.T@ H\nprint(Q.toarray().astype(np.int))","position":{"start":{"line":161,"column":1},"end":{"line":164,"column":1}},"key":"yDQWQtfqXK"},{"type":"code","lang":"","value":"[[ 2 -1 -1  0  0  0]\n [-1  3 -1 -1  0  0]\n [-1 -1  4 -1 -1  0]\n [ 0 -1 -1  4 -1 -1]\n [ 0  0 -1 -1  3 -1]\n [ 0  0  0 -1 -1  2]]","position":{"start":{"line":166,"column":1},"end":{"line":171,"column":1}},"key":"kvj7EfOZry"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"Graph theory also defines the ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"MjD7syJTsx"},{"type":"link","url":"https://en.wikipedia.org/wiki/Laplacian_matrix","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"Laplacian Matrix","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"tsk4BbORbr"}],"urlSource":"https://en.wikipedia.org/wiki/Laplacian_matrix","data":{"page":"Laplacian_matrix","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"LgyBpVZLMt"},{"type":"text","value":" ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"VM7TF6EFBa"},{"type":"inlineMath","value":"L=D-A","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo>=</mo><mi>D</mi><mo>−</mo><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">L=D-A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"pXkcuuEozU"},{"type":"text","value":" of an undirected graph ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"Dr3Cl6iVnQ"},{"type":"inlineMath","value":"G","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"rNEuP9Xv0u"},{"type":"text","value":", where ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"sI692eFjTB"},{"type":"inlineMath","value":"D","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"PSLM7Y0CSY"},{"type":"text","value":" is a diagonal degree matrix and ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"AbcJLUg0Lg"},{"type":"inlineMath","value":"A","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"KHeb2unolj"},{"type":"text","value":" is the adjacency matrix of the graph.","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"fXn32QtPRq"}],"key":"JhuMsVoYS3"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"The Laplacian ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"N7ozaAyxO3"},{"type":"inlineMath","value":"L","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"GiPbEc0Rla"},{"type":"text","value":" associated with this matrix is easy to calculate, but we’ll use ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"Z22k10bnVo"},{"type":"inlineCode","value":"networkx","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"V65xRmBSaZ"},{"type":"text","value":" to do it for us:","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"vDXMPErTnI"}],"key":"UcvJZStKRa"},{"type":"code","lang":"","value":"L = nx.linalg.laplacian_matrix(G).toarray()\nprint(L)","position":{"start":{"line":179,"column":1},"end":{"line":182,"column":1}},"key":"bkxQRMmvUY"},{"type":"code","lang":"","value":"[[ 2 -1 -1  0  0  0]\n [-1  3 -1 -1  0  0]\n [-1 -1  4 -1 -1  0]\n [ 0 -1 -1  4 -1 -1]\n [ 0  0 -1 -1  3 -1]\n [ 0  0  0 -1 -1  2]]","position":{"start":{"line":184,"column":1},"end":{"line":189,"column":1}},"key":"iKO2gBc3St"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"As we can see, ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"rlpNNaiAdD"},{"type":"strong","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"for this problem the Hessian and the Graph Laplacian are identical","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"aI1TNk5mLJ"}],"key":"qnaEWxjSM6"},{"type":"text","value":".","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"Mg6IAvhAFh"}],"key":"eMtv3MiTex"},{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"This nicely connects estimation and graph theory. In particular, in graph theory the eigenvalues and eigenvectors of the graph Laplacian ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"A6r3OKhtMS"},{"type":"inlineMath","value":"L","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"EjP4uIW7J4"},{"type":"text","value":" are of particular interest, and we will be able to connect them to the SVD of the measurement matrix ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"vISc8a5jiO"},{"type":"inlineMath","value":"H","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"khtyaKYN1B"},{"type":"text","value":" and by extension ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"sDMatNFgJE"},{"type":"inlineMath","value":"Q","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"oLwC3AHl2A"},{"type":"text","value":".","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"Hd83jFlYyg"}],"key":"z2SoOwba2r"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"First, let us calculate the eigen-decomposition of ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"SA1mxggZ8d"},{"type":"inlineMath","value":"L","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"suxbvT2XR7"},{"type":"text","value":". We will use the ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"q6QMOVwuqb"},{"type":"link","url":"https://en.wikipedia.org/wiki/Singular_value_decomposition","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"singular value decomposition or SVD","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"ulikJOl30T"}],"urlSource":"https://en.wikipedia.org/wiki/Singular_value_decomposition","data":{"page":"Singular_value_decomposition","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"eeJhoKFqiN"},{"type":"text","value":" to do this as that nicely sorts the eigenvalues for us in decreasing magnitude order:","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"sKXOSTZ5su"}],"key":"KIjAZk25SJ"},{"type":"code","lang":"","value":"eigenvectors, eigenvalues, _ = np.linalg.svd(L)\nprint(np.round(eigenvalues,2))\nprint(np.round(eigenvectors,2))","position":{"start":{"line":199,"column":1},"end":{"line":203,"column":1}},"key":"AKJ47wkxSN"},{"type":"code","lang":"","value":"[5.34 5.   3.47 3.   1.19 0.  ]\n[[ 0.23  0.   -0.29  0.58  0.6   0.41]\n [-0.1  -0.5   0.62 -0.29  0.33  0.41]\n [-0.66  0.5  -0.19 -0.29  0.16  0.41]\n [ 0.66  0.5   0.19 -0.29 -0.16  0.41]\n [ 0.1  -0.5  -0.62 -0.29 -0.33  0.41]\n [-0.23  0.    0.29  0.58 -0.6   0.41]]","position":{"start":{"line":205,"column":1},"end":{"line":211,"column":1}},"key":"TYPuLqi8oo"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"However, because we have ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"ENBunMIiuM"},{"type":"inlineMath","value":"L=Q=H^TH","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo>=</mo><mi>Q</mi><mo>=</mo><msup><mi>H</mi><mi>T</mi></msup><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">L=Q=H^TH</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"Q35uSBvKDd"},{"type":"text","value":", we can ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"JOXGNwQROZ"},{"type":"emphasis","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"also","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"prMXjQJrxv"}],"key":"BVi0MHQeai"},{"type":"text","value":" do obtain this by taking the SVD of ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"vhHFQBnk3D"},{"type":"inlineMath","value":"H","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"hKghmomMKC"},{"type":"text","value":":","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"xrtsct0HhO"}],"key":"jupFM1jzLC"},{"type":"code","lang":"","value":"_, S, V = np.linalg.svd(H.toarray())\nprint(np.round(S**2,2)) # square to get eigenvalues of Q!\nprint(np.round(V.transpose(),2))","position":{"start":{"line":217,"column":1},"end":{"line":221,"column":1}},"key":"IFFvrvjzoS"},{"type":"code","lang":"","value":"[5.34 5.   3.47 3.   1.19 0.  ]\n[[ 0.23 -0.   -0.29  0.58  0.6  -0.41]\n [-0.1  -0.5   0.62 -0.29  0.33 -0.41]\n [-0.66  0.5  -0.19 -0.29  0.16 -0.41]\n [ 0.66  0.5   0.19 -0.29 -0.16 -0.41]\n [ 0.1  -0.5  -0.62 -0.29 -0.33 -0.41]\n [-0.23 -0.    0.29  0.58 -0.6  -0.41]]","position":{"start":{"line":223,"column":1},"end":{"line":229,"column":1}},"key":"suDyzCz9fU"},{"type":"paragraph","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"Based on this, we can start to understand some properties that are often discussed in the context of the graph Laplacian:","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"c5WekkVXNu"}],"key":"XKmfpk1VYh"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"strong","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"1. The smallest eigenvalue of ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"RzA9aEma8Y"},{"type":"inlineMath","value":"L","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"Rts7Vd69QH"},{"type":"text","value":" is zero, and the associated eigenvector is all ones, up to a scale.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"lTaaJRRNWv"}],"key":"qGfcAwTy1i"}],"key":"doWSQz1itt"},{"type":"code","lang":"","value":"print(\"Eigenvalues=\\n  {}\".format(np.round(eigenvalues,2)), \n      \"\\nEigenvector associated with first zero=\\n  {}\".format(np.round(eigenvectors[:,-1],2))\n      )","position":{"start":{"line":237,"column":1},"end":{"line":241,"column":1}},"key":"aqVbE8Epig"},{"type":"code","lang":"","value":"Eigenvalues=\n  [5.34 5.   3.47 3.   1.19 0.  ] \nEigenvector associated with first zero=\n  [0.41 0.41 0.41 0.41 0.41 0.41]","position":{"start":{"line":243,"column":1},"end":{"line":246,"column":1}},"key":"f9XgHeKfv9"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"Let’s unpack this: if we interpret the graph Laplacian ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"J7OdXKDwWA"},{"type":"inlineMath","value":"L","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"aPPWvLbJ0n"},{"type":"text","value":" as an the information matrix ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"xuvvSY4qSw"},{"type":"inlineMath","value":"Q","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"zLCilRCHtV"},{"type":"text","value":" the result above says that there is a direction in the space of unknowns in which we have ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"pRxlZG4Fc7"},{"type":"emphasis","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"zero information","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"xuZVszRgeo"}],"key":"X4W9tNXGtU"},{"type":"text","value":". This makes total sense: since we only have ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"JEwxIiYgzA"},{"type":"emphasis","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"relative","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"Uu3SmMvfPS"}],"key":"B7f7bpB9RE"},{"type":"text","value":" measurements, we can add a constant without changing the objective function: that corresponds to the first eigenvector.","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"sBTrthLemd"}],"key":"tKlJ7Nu2YO"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"strong","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"2. If the graph ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"vSQnAVoSES"},{"type":"inlineMath","value":"G","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"SYXSHVt0k4"},{"type":"text","value":" is disconnected, the second eigenvalue is also zero.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"yuQxkv1z2z"}],"key":"zyimkSf9jx"}],"key":"Hcc1VxDtq3"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"We can examine this by looking at two mountaintops, by just replicating H:","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"OCvcvHSyfF"}],"key":"Vg6Do9WpDp"},{"type":"code","lang":"","value":"H2 = np.zeros((2*M,2*N))\nH2[:M,:N]=H.toarray()\nH2[M:,N:]=H.toarray()\nQ2 = H2.T @ H2\neigenvectors2, eigenvalues2, _ = np.linalg.svd(Q2)\nprint(\"Eigenvalues=\\n  {}\".format(np.round(eigenvalues2)), \n      \"\\nEigenvector associated with first zero=\\n  {}\".format(np.round(eigenvectors2[:,-1],2)),\n      \"\\nEigenvector associated with second zero=\\n  {}\".format(np.round(eigenvectors2[:,-2],2))\n      )","position":{"start":{"line":256,"column":1},"end":{"line":266,"column":1}},"key":"bHyDptvyKD"},{"type":"code","lang":"","value":"Eigenvalues=\n  [5. 5. 5. 5. 3. 3. 3. 3. 1. 1. 0. 0.] \nEigenvector associated with first zero=\n  [-0.   -0.   -0.   -0.   -0.   -0.    0.41  0.41  0.41  0.41  0.41  0.41] \nEigenvector associated with second zero=\n  [ 0.41  0.41  0.41  0.41  0.41  0.41 -0.    0.    0.    0.    0.    0.  ]","position":{"start":{"line":268,"column":1},"end":{"line":273,"column":1}},"key":"O9Cycpwbro"},{"type":"paragraph","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"This is also not surprising: even though this simulates scaling the two mountain tops and recording our elevation changes, we have no measurements connecting the two mountains, and hence we can ","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"IaSQiBB1N4"},{"type":"emphasis","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"independently","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"kSk84QvY7z"}],"key":"hX1MB7t6GQ"},{"type":"text","value":" vary the height of either mountain, without violating any measurement constraint. That corresponds to the two eigenvectors associated with the two zero eigenvalues.","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"vVtAAM14QQ"}],"key":"XP4Brf7gRJ"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"This is also the basis for ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"pyN0WXvoPb"},{"type":"link","url":"https://en.wikipedia.org/wiki/Spectral_clustering","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"spectral partitioning/clustering mtehods","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"pHsS9KBc2q"}],"urlSource":"https://en.wikipedia.org/wiki/Spectral_clustering","data":{"page":"Spectral_clustering","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"z4GSDxIvpz"},{"type":"text","value":": the eigenvectors neatly separate the graph into two components, and this can be generalized to more sophisticated clustering methods.","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"faVfy6Hf4t"}],"key":"lHWQ2zPCvN"},{"type":"paragraph","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"This is even better appreciated by plotting both eigenvectors:","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"w5NFAaYJBO"}],"key":"h3UZWJRw70"},{"type":"code","lang":"","value":"fig=plt.plot(eigenvectors2[:,-2:],'--*')","position":{"start":{"line":283,"column":1},"end":{"line":285,"column":1}},"key":"YLUYXLgfGq"},{"type":"image","url":"/Laplacian_34_0-05110190ed2a70e1cbaab1eac62f7e3a.png","alt":"png","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"FHCAgkfqdZ","urlSource":"/_static/Laplacian//Laplacian_34_0.png"},{"type":"paragraph","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"strong","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"3. The second-smallest eigenvalue, called the ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"Wp3qGgFN0p"},{"type":"link","url":"https://en.wikipedia.org/wiki/Algebraic_connectivity","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"Algebraic Connectivity or Fiedler value","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"OqwFvpA8oc"}],"urlSource":"https://en.wikipedia.org/wiki/Algebraic_connectivity","data":{"page":"Algebraic_connectivity","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"SWzP98942n"},{"type":"text","value":" is greater than zero if the graph is connected, and measures the global connectivity in the graph.","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"Ah5dHjtRfh"}],"key":"qlF9x4x3gd"}],"key":"K1M8iuyrJi"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"In our original 6-node mountain top problem, the Fiedler value is approximatey 1.19:","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"oxW73TdKXl"}],"key":"Y4rydCFSJZ"},{"type":"code","lang":"","value":"print(\"lambda = {}\".format(round(eigenvalues[-2],2)))\nprint(\"with networkx: {}\".format(round(nx.algebraic_connectivity(G),2)))","position":{"start":{"line":297,"column":1},"end":{"line":300,"column":1}},"key":"OnBAUiXP6e"},{"type":"code","lang":"","value":"lambda = 1.19\nwith networkx: 1.19","position":{"start":{"line":302,"column":1},"end":{"line":303,"column":1}},"key":"WLNV1MXSM4"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"strong","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"4. The eigenvector associated with the Fiedler value, also called the “Fiedler vector”, is the direction in space that incurs the least error in the scalar synchronization problem.","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"aMR8VoXvrc"}],"key":"x8EMxIgLyO"}],"key":"lR3FTQenTf"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"Indeed: the direction that incurs the least error is also the one we have the least ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"qlrfVzFdxI"},{"type":"emphasis","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"information","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"Y1mD7ppARF"}],"key":"FaowXSVhud"},{"type":"text","value":" about: highly informative measurements will incur a high error if they are violated. Note that by “error” we mean the quadratic objective function, not the difference between our solution and the ground truth, which we in general do not have access to.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"G4eICyXVwU"}],"key":"ukEkUncECR"},{"type":"paragraph","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"Per the spectral clustering idea, it can also be used to partition the graph into two parts, even if the graph is not disconnected. This can be appreciated by plotting the Fiedler vector for the original mountain top:","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"ybaGth4bxP"}],"key":"AMJVEK6peA"},{"type":"code","lang":"","value":"fig=plt.plot(eigenvectors[:,-2], '-*')\nplt.legend([\"$\\lambda = {}$\".format(round(eigenvalues[-2],2))],loc='upper right');","position":{"start":{"line":313,"column":1},"end":{"line":316,"column":1}},"key":"PDZy53vQDo"},{"type":"image","url":"/Laplacian_38_0-08904c240870f3ae827baf6af690f098.png","alt":"png","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"uTemj7vbRW","urlSource":"/_static/Laplacian//Laplacian_38_0.png"},{"type":"paragraph","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"Just by thresholding on zero we can neatly partition the mountain in the left half, and the right half!","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"ZTNcTDPCGR"}],"key":"f06KoLVSjf"},{"type":"paragraph","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"strong","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"5. The remaining eigenvectors of ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"yNiAgUTI55"},{"type":"inlineMath","value":"L","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"zVVUPBCdgz"},{"type":"text","value":" (or ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"PE8sA26biB"},{"type":"inlineMath","value":"Q","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"jfn11OCYYU"},{"type":"text","value":") are increasingly “high frequency” modes that identify directions in space that incur high costs.","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"MqVMwFmApm"}],"key":"YOo7jXTZks"}],"key":"P7kMKRuXeF"},{"type":"code","lang":"","value":"fig, ax = plt.subplots(figsize=(10, 5))\nax.plot(eigenvectors[:,:-2])\nplt.legend([\"$\\lambda_{} = {}$\".format(5-i, round(e,2)) for i,e in enumerate(eigenvalues[:-2])],loc='lower left');","position":{"start":{"line":328,"column":1},"end":{"line":332,"column":1}},"key":"qKpkLvewfr"},{"type":"image","url":"/Laplacian_41_0-30dda16c8241c88162b6d3a52ef2e39c.png","alt":"png","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"CHFmdDmzl0","urlSource":"/_static/Laplacian//Laplacian_41_0.png"},{"type":"paragraph","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"For example, the blue “mode” associated with ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"VtwvttmY4v"},{"type":"inlineMath","value":"\\lambda_5","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>λ</mi><mn>5</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\lambda_5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pJsxVbmfyy"},{"type":"text","value":" shows that modifying the values of neighboring nodes 2 and 3 in opposite ways will be quite expensive.","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"q6ZNUViwRm"}],"key":"FzCaJRUWfE"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"The SVD is a generalization of the Fourier transform, in that the SVD of the Laplacian of a ring ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"f9NDvXRUCH"},{"type":"emphasis","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"will","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"yu9csOv7Kq"}],"key":"RkG82yXDEV"},{"type":"text","value":" in fact yield the DFT:","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"P7PPxuCa2J"}],"key":"TTdnOxkaWy"},{"type":"code","lang":"","value":"G3 = nx.watts_strogatz_graph(64, 2, 0) # ring is simply special case of WS graph\nfig, ax = plt.subplots(ncols=3,figsize=(13, 4))\nnx.draw_circular(G3, node_size=25, ax=ax[0])\nL3 = nx.linalg.laplacian_matrix(G3).toarray()\neigenvectors3, eigenvalues3, _ = np.linalg.svd(L3)\nax[1].plot(eigenvectors3[:,-3:]);\nax[2].plot(eigenvectors3[:,-5:-3]);","position":{"start":{"line":343,"column":1},"end":{"line":351,"column":1}},"key":"OQcyAdYvKP"},{"type":"image","url":"/Laplacian_43_0-a4d05a1e9d2a77b7c447cd88b6e694eb.png","alt":"png","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"TZGKX11lOn","urlSource":"/_static/Laplacian//Laplacian_43_0.png"},{"type":"paragraph","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"children":[{"type":"text","value":"Just to close the thread, as we saw before in the Mount Rainier example, if we have an absolute measurement then we can simply add a “prior” to our factor graph ","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"YuwIi2dw6B"},{"type":"inlineMath","value":"H","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"KB3VikiUZA"},{"type":"text","value":" and RHS ","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"V3SdMTAutz"},{"type":"inlineMath","value":"d","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"Whsk5RhopN"},{"type":"text","value":", and we will get a definite answer:","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"fBdwdjdeQV"}],"key":"m6ORfPmhPf"},{"type":"code","lang":"","value":"H1 = np.concatenate((H.toarray(), [[1,0,0,0,0,0]]), axis=0)\nd1 = np.concatenate((d,[100]))\nQ1 = H1.T @ H1\nz = np.linalg.inv(Q1) @ H1.T @ d1\nprint(z)","position":{"start":{"line":360,"column":1},"end":{"line":366,"column":1}},"key":"RfLWFiqnku"},{"type":"code","lang":"","value":"[100.         121.27268328 130.98429722 120.60191527 111.20576812\n 111.48345044]","position":{"start":{"line":368,"column":1},"end":{"line":369,"column":1}},"key":"KNBAj0haxg"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"Because there is no contradictory information regarding the value of ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"Sw6iAl4oax"},{"type":"inlineMath","value":"z_0","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sSVP25BzeD"},{"type":"text","value":", the solution adopts that prior exactly.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"EdJfIaxs3R"}],"key":"MZIzyU5Xv1"},{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"It is instructive to abandon the “pure Laplacian” view here and look at the eigenvalues and eigenvectors of the Hessian of this new problem, which is no longer indeterminate:","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"GDGGg6YiBy"}],"key":"AJ7HgrimQs"},{"type":"code","lang":"","value":"eigenvectors, eigenvalues, _ = np.linalg.svd(Q1)\nfig, ax = plt.subplots(figsize=(10, 5))\nax.plot(eigenvectors)\nax.legend([\"$\\lambda_{} = {}$\".format(5-i, round(e,2)) for i,e in enumerate(eigenvalues)],loc='lower right');","position":{"start":{"line":377,"column":1},"end":{"line":382,"column":1}},"key":"fFB04zqlU9"},{"type":"image","url":"/Laplacian_47_0-66b4110e1ff9d2aa5f01e1f8566d709a.png","alt":"png","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"gnWnmuEldN","urlSource":"/_static/Laplacian//Laplacian_47_0.png"},{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"As you can see:","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"ibtuZuE3bO"}],"key":"cf9vF6ONGR"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":390,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"the smallest eigenvalue is no longer zero: we now incur a definite cost of moving up and down, but the eigenvector associated with ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"jFbhLU3UKh"},{"type":"inlineMath","value":"\\lambda_1","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\lambda_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qq5Tbo9VPN"},{"type":"text","value":" suggests that it this is less so for nodes far away from the “anchor node”.","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"xy6bsEzBtP"}],"key":"ZQ7Umca9fr"},{"type":"listItem","spread":true,"position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"children":[{"type":"text","value":"The eigenvectors associated with ","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"Vqot94W5zL"},{"type":"inlineMath","value":"\\lambda_5","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>λ</mi><mn>5</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\lambda_5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JQEzNjhWC2"},{"type":"text","value":" has a zero in the front and its eigenvalue is the same as before.","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"PKFno4elr2"}],"key":"HySgE08nLB"},{"type":"listItem","spread":true,"position":{"start":{"line":392,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"The remaining eigenvectors have larger eigenvalues as they also change the anchor node, which now has higher cost.","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"NwOOf4Q9As"}],"key":"ZFOGfyJtYE"}],"key":"dAWGXxsFIn"},{"type":"heading","depth":2,"position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"children":[{"type":"text","value":"Mount Rainier’s Eigenvectors","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"ECPojh2tPY"}],"identifier":"mount-rainiers-eigenvectors","label":"Mount Rainier’s Eigenvectors","html_id":"mount-rainiers-eigenvectors","implicit":true,"key":"MdFVNUlW3l"},{"type":"paragraph","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"We will use the sparse/fast methods from networkx to calculate the Fiedler value and Fiedler vector:","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"TX78FG2jzM"}],"key":"tixLC6Qn0L"},{"type":"code","lang":"","value":"fiedler_value = nx.algebraic_connectivity(G0)\nprint(fiedler_value)\nfiedler_vector = nx.fiedler_vector(G0)\nplt.plot(fiedler_vector);","position":{"start":{"line":402,"column":1},"end":{"line":407,"column":1}},"key":"OC32uVPYLA"},{"type":"code","lang":"","value":"0.053047495666829085","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"Oz2xBamUQx"},{"type":"image","url":"/Laplacian_51_1-c800f8bd859f2e3ffe06e96f18c4bf7b.png","alt":"png","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"XVnxlc4hQJ","urlSource":"/_static/Laplacian//Laplacian_51_1.png"},{"type":"paragraph","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"text","value":"This does not look very good in 1D, so let’s plot it in 3D, using a color map to encode the Fiedler vector’s values:","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"N9FmIYjPRq"}],"key":"xS9GC6SpHM"},{"type":"code","lang":"","value":"fig = plt.figure(figsize=(12,8))\nax = fig.add_subplot(111, projection='3d')\nz = truth[:,2]\nax.scatter(truth[:,0], truth[:,1], z, marker='.', c=fiedler_vector,cmap='RdYlGn');","position":{"start":{"line":419,"column":1},"end":{"line":424,"column":1}},"key":"DEePNj3RPI"},{"type":"image","url":"/Laplacian_53_0-42871ab071ccbb423204510a13d8ef6e.png","alt":"png","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"b9IxMpsi6S","urlSource":"/_static/Laplacian//Laplacian_53_0.png"},{"type":"paragraph","position":{"start":{"line":430,"column":1},"end":{"line":430,"column":1}},"children":[{"type":"text","value":"It is even clearer from the top: below we plot an overhead view, in which we can clearly see that the two “halves” of Mount Rainier can move more or less independently without incurring much error. Hence, this is the lowest frequency mode over which we do have some information (but not much).","position":{"start":{"line":430,"column":1},"end":{"line":430,"column":1}},"key":"yPvbnMGQ0a"}],"key":"EVBzonvipu"},{"type":"paragraph","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"If you are running the notebook, you could try playing with the number of neighbors in the KNN calculation, and see how the Fiedler vector changes as a result.","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"rL7CuRoCK7"}],"key":"yrriWdiOAg"},{"type":"code","lang":"","value":"fig = plt.figure(figsize=(12,8))\nax = fig.add_subplot(111)\nz = truth[:,2]\nax.scatter(truth[:,0], truth[:,1], marker='.', c=fiedler_vector,cmap='RdYlGn');","position":{"start":{"line":435,"column":1},"end":{"line":440,"column":1}},"key":"DumzhEmziM"},{"type":"image","url":"/Laplacian_55_0-741c875bd86d92675bbddbc5d6eabb75.png","alt":"png","position":{"start":{"line":443,"column":1},"end":{"line":443,"column":1}},"key":"k8DQxHsuVG","urlSource":"/_static/Laplacian//Laplacian_55_0.png"},{"type":"heading","depth":2,"position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"Other Synchronization Problems","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"ZHKk3BdLxL"}],"identifier":"other-synchronization-problems","label":"Other Synchronization Problems","html_id":"other-synchronization-problems","implicit":true,"key":"a3OYk4XWzn"},{"type":"paragraph","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"children":[{"type":"text","value":"The “mountain shape” problems we discussed above are instances of a class of estimation problems called ","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"qAWB1H3Tvy"},{"type":"strong","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"children":[{"type":"text","value":"synchronization problems","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"Rqqs93RPaE"}],"key":"TciL0YvfQ2"},{"type":"text","value":", in which we are given a set of ","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"VR4ZaHgYXh"},{"type":"emphasis","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"children":[{"type":"text","value":"pairwise relative measurements","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"XMinKSHR2m"}],"key":"Dm6i1oAMC2"},{"type":"text","value":", and our goal is to estimate a set of absolute quantities.","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"Tv6CZDK8sE"}],"key":"CNKrlVEyWk"},{"type":"paragraph","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"children":[{"type":"text","value":"Arguably the most studied synchronization problem in computer vision is ","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"zrYsq9nWKl"},{"type":"emphasis","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"children":[{"type":"text","value":"rotation averaging","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"UtAFi9T6Ea"}],"key":"qnGgJVwKKK"},{"type":"text","value":", where we are given a set of relative rotations ","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"u9Ogzh4Z1l"},{"type":"inlineMath","value":"R_{ij}","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ytQWIviL1y"},{"type":"text","value":" between cameras and the goal is to estimate the absolute orientation ","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"qesZEKhpQb"},{"type":"inlineMath","value":"R_i","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"UPLZAJPd7h"},{"type":"text","value":" for every camera. This is a crucial step in 3D reconstruction algorithms.","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"RX3wind5pU"}],"key":"CL7rXDQQg3"},{"type":"paragraph","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"We have recently published a paper on ","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"gOSVK5vO4s"},{"type":"link","url":"https://dellaert.github.io/ShonanAveraging/","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"Shonan Rotation Averaging","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"Eyg1DFvGdY"}],"urlSource":"https://dellaert.github.io/ShonanAveraging/","key":"IaT8N0wBnE"},{"type":"text","value":", where the eigenvalue and eigenvectors of the graph Laplacian are used in both the analysis and convergence certificates.","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"nnyneWAvw7"}],"key":"LhK4zXLwNl"}],"key":"lbkczBeCNC"}],"key":"ffJioxvopE"},"references":{"cite":{"order":[],"data":{}}}}