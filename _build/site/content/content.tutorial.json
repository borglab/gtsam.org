{"version":1,"kind":"Article","sha256":"905ff30e58aa3c927d2aa39cb5031574091fbfe9b8696ad89851d3f99b6c8bb7","slug":"content.tutorial","location":"/Content/tutorial.md","dependencies":[],"frontmatter":{"title":"Factor Graphs and GTSAM","date":"2019-05-22","github":"https://github.com/borglab/gtsam","edit_url":"https://github.com/borglab/gtsam/blob/docs/ktk-sdk/Content/tutorial.md","thumbnail":"/1_hmm-b990909ae5fc7125544ee7aa187b08e7.png","exports":[{"format":"md","filename":"tutorial.md","url":"/tutorial-bf72cf27d8da188ea3f2201a63d75ca9.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This is an updated version of the 2012 tech-report ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"nGAxN7yyIX"},{"type":"link","url":"http://borg.cc.gatech.edu/sites/edu.borg/files/downloads/gtsam.pdf","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Factor Graphs and GTSAM: A Hands-on Introduction","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Ys0BpEfu98"}],"urlSource":"http://borg.cc.gatech.edu/sites/edu.borg/files/downloads/gtsam.pdf","key":"TUp994oRaB"},{"type":"text","value":" by ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"d6P99SNOHh"},{"type":"link","url":"http://frank.dellaert.com/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Frank Dellaert","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bmwmESS0YA"}],"urlSource":"http://frank.dellaert.com/","key":"c5XnB6nMBM"},{"type":"text","value":". A more thorough introduction to the use of factor graphs in robotics is the 2017 article ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"FjpW8EZmnt"},{"type":"link","url":"https://dellaert.github.io/files/Dellaert17fnt.pdf","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Factor graphs for robot perception","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"N15vbPs8Gw"}],"urlSource":"https://dellaert.github.io/files/Dellaert17fnt.pdf","key":"c0LirD7F8K"},{"type":"text","value":" by Frank Dellaert and Michael Kaess.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NFD5RfjUMo"}],"key":"fZlO6HwuCf"},{"type":"heading","depth":2,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"gioz40wZTB"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"k5LKjkn37w"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Factor graphs","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kARlINOeHN"}],"key":"FkJOq2sqCp"},{"type":"text","value":" are graphical models (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DetMD2E6t4"},{"type":"link","url":"https://gtsam.org/tutorials/intro.html#LyXCite-Koller09book","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Koller and Friedman, 2009","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HUq0AyrBel"}],"urlSource":"https://gtsam.org/tutorials/intro.html#LyXCite-Koller09book","key":"W79vqoQAQ9"},{"type":"text","value":") that are well suited to modeling complex estimation problems, such as Simultaneous Localization and Mapping (SLAM) or Structure from Motion (SFM). You might be familiar with another often used graphical model, Bayes networks, which are directed acyclic graphs. A ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"FoHFN7u3Ls"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"factor graph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"lHe6nxs3K4"}],"key":"k3TRaof9ju"},{"type":"text","value":", however, is a ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"xMNl5ASeNV"},{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"bipartite","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"SaNATfNA2f"}],"key":"fwZPjCFL8d"},{"type":"text","value":" graph consisting of factors connected to variables. The ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"XzKtwAAtzg"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"variables","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"sKHs3PmpHe"}],"key":"TczdgAHSI6"},{"type":"text","value":" represent the unknown random variables in the estimation problem, whereas the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"cnI1bK8xTq"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"factors","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"bX9nlzRbBs"}],"key":"Gc1SLDcjlZ"},{"type":"text","value":" represent probabilistic constraints on those variables, derived from measurements or prior knowledge. In the following sections I will illustrate this with examples from both robotics and vision.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Xqhs7RWUqO"}],"key":"kf2LK9tl7p"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The GTSAM toolbox (GTSAM stands for “Georgia Tech Smoothing and Mapping”) toolbox is a BSD-licensed C++ library based on factor graphs, developed at the Georgia Institute of Technology by myself, many of my students, and collaborators. It provides state of the art solutions to the SLAM and SFM problems, but can also be used to model and solve both simpler and more complex estimation problems. It also provides a MATLAB interface which allows for rapid prototype development, visualization, and user interaction.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Hy3pFCIav4"}],"key":"uOa0M94Cy8"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"GTSAM exploits sparsity to be computationally efficient. Typically measurements only provide information on the relationship between a handful of variables, and hence the resulting factor graph will be sparsely connected. This is exploited by the algorithms implemented in GTSAM to reduce computational complexity. Even when graphs are too dense to be handled efficiently by direct methods, GTSAM provides iterative methods that are quite efficient regardless.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"LwrtPC7gaC"}],"key":"YvyVgZqVCQ"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"You can download the latest version of GTSAM from our ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pO2dnw8eUb"},{"type":"link","url":"https://github.com/borglab/gtsam","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Github repo","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"aX9MQUPaCv"}],"urlSource":"https://github.com/borglab/gtsam","error":true,"key":"UcY1uf3KaD"},{"type":"text","value":".","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"iBaMuzZqll"}],"key":"P5POkYyAmg"},{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"1. Factor Graphs","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ccjjOHvMNj"}],"identifier":"id-1-factor-graphs","label":"1. Factor Graphs","html_id":"id-1-factor-graphs","implicit":true,"key":"ankZbh2cwE"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Let us start with a one-page primer on factor graphs, which in no way replaces the excellent and detailed reviews by ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"VGDR0LVYA6"},{"type":"cite","kind":"narrative","label":"Kschischang2001","identifier":"kschischang2001","children":[{"type":"text","value":"Kschischang & Loeliger (2001)","key":"TgXx0OsCQN"}],"enumerator":"1","key":"GAUEsI1s4C"},{"type":"text","value":" and ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"deaHOIYEkg"},{"type":"cite","kind":"narrative","label":"Loeliger2004","identifier":"loeliger2004","children":[{"type":"text","value":"Loeliger (2004)","key":"wq42JjrIUd"}],"enumerator":"2","key":"juFbA8vUeb"},{"type":"text","value":" (2004).","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"t4ExAMUaql"}],"key":"LTQhQ3qHnZ"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/1_hmm-b990909ae5fc7125544ee7aa187b08e7.png","alt":"An HMM, unrolled over three time-steps, represented by a Bayes net.","data":{"altTextIsAutoGenerated":true},"key":"XVX8EtyXDq","urlSource":"_static/Tutorial/1_hmm.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 1","identifier":"figure 1","html_id":"figure-1","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"Iz2vjtZx7I"},{"type":"text","value":"1","key":"agon7k3gMm"},{"type":"text","value":":","key":"z0fDuSZ2J4"}],"template":"Figure %s:","key":"XdtP2emjU8"},{"type":"text","value":"An HMM, unrolled over three time-steps, represented by a Bayes net.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"QGxLq1lgSP"}],"key":"TkHwBNSZnD"}],"key":"BAHf2Zn3x2"}],"label":"Figure 1","identifier":"figure 1","enumerator":"1","html_id":"figure-1","key":"A5w3U0BQM6"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Figure 1","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"g5G27BsYre"}],"key":"vTyU2ZCBMB"},{"type":"text","value":" shows the Bayes network for a hidden Markov model (HMM) over three time steps. In a Bayes net, each node is associated with a conditional density: the top Markov chain encodes the prior ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ONDt7kk5VG"},{"type":"inlineMath","value":"P(X_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(X_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ImLmRjNApT"},{"type":"text","value":" and transition probabilities ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"Dtz5GswbMk"},{"type":"inlineMath","value":"P(X_2|X_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>X</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(X_2|X_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"UnjVgW33I2"},{"type":"text","value":" and ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"NROBv4jAeb"},{"type":"inlineMath","value":"P(X_3|X_2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>3</mn></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>X</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(X_3|X_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"YZKpbeGvhL"},{"type":"text","value":", whereas measurements ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"onI7qspi9M"},{"type":"inlineMath","value":"Z_t","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">Z_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"t88kpRFzlp"},{"type":"text","value":" depend only on the state ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"MIC3idzil6"},{"type":"inlineMath","value":"X_t","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wD3S8tGYKM"},{"type":"text","value":", modeled by conditional densities ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"Yb8PIxSPHg"},{"type":"inlineMath","value":"P(Z_t|X_t)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>Z</mi><mi>t</mi></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>X</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(Z_t|X_t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"fXoIhddVWY"},{"type":"text","value":".","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"bpdyq12g0b"}],"key":"Es3DIeSpBo"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Given known measurements ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"F2kvuuuGTz"},{"type":"inlineMath","value":"z_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"m7A286wUQr"},{"type":"text","value":", ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"dDDxEJsHXE"},{"type":"inlineMath","value":"z_2","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gWsfoon9Jl"},{"type":"text","value":", and ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"NsU0QCNYEl"},{"type":"inlineMath","value":"z_3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NxztR8WqHL"},{"type":"text","value":" we are interested in the hidden state sequence ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"V4RyaYs16y"},{"type":"inlineMath","value":"(X_1, X_2, X_3)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(X_1, X_2, X_3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"oEOA0zQTJ7"},{"type":"text","value":" that maximizes the posterior probability ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"QsA0H5OfJ9"},{"type":"inlineMath","value":"P(X_1, X_2, X_3 | Z_1 = z_1, Z_2 = z_2, Z_3 = z_3)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>3</mn></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><msub><mi>z</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>Z</mi><mn>3</mn></msub><mo>=</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(X_1, X_2, X_3 | Z_1 = z_1, Z_2 = z_2, Z_3 = z_3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"I8EkYnH4zA"},{"type":"text","value":". Since the measurements ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"rxGoVjRodE"},{"type":"inlineMath","value":"z_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Q60MsiQh1G"},{"type":"text","value":", ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"xhLJigtMbL"},{"type":"inlineMath","value":"z_2","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sdXB7puiHA"},{"type":"text","value":", and ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"NXrmG5vUqx"},{"type":"inlineMath","value":"z_3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">z_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qidmmVolFs"},{"type":"text","value":" are ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"dRLyOQG8Ro"},{"type":"emphasis","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"known","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"uEy8y76DXD"}],"key":"YcTN8nI0Xh"},{"type":"text","value":", the posterior is proportional to the product of six ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"WU0qssZnnv"},{"type":"strong","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"factors","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"dlPAwREQiz"}],"key":"xL2JsrQC2f"},{"type":"text","value":", three of which derive from the the Markov chain, and three likelihood factors defined as ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"iyarCCREkm"},{"type":"inlineMath","value":"L(X_t; z) \\propto P(Z_t = z | X_t)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo separator=\"true\">;</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>∝</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>Z</mi><mi>t</mi></msub><mo>=</mo><mi>z</mi><mi mathvariant=\"normal\">∣</mi><msub><mi>X</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(X_t; z) \\propto P(Z_t = z | X_t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∝</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"EkgBCNCsEj"},{"type":"text","value":":","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"lXt6tVRpvv"}],"key":"fEkosgevrz"},{"type":"math","value":"P(X_1, X_2, X_3 | Z_1 = z_1, Z_2 = z_2, Z_3 = z_3) \\propto P(X_1) P(X_2|X_1) P(X_3|X_2) L(X_1; z_1) L(X_2; z_2) L(X_3; z_3)","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>3</mn></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><msub><mi>z</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>Z</mi><mn>3</mn></msub><mo>=</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo><mo>∝</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>X</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>3</mn></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>X</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mi>L</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=\"true\">;</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mi>L</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator=\"true\">;</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mi>L</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>3</mn></msub><mo separator=\"true\">;</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(X_1, X_2, X_3 | Z_1 = z_1, Z_2 = z_2, Z_3 = z_3) \\propto P(X_1) P(X_2|X_1) P(X_3|X_2) L(X_1; z_1) L(X_2; z_2) L(X_3; z_3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∝</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"1","key":"jcsWW8ZF8O"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/2_hmm-FG-e8784db9872b405597d3917e898b3d7c.png","alt":"An HMM with observed measurements, unrolled over time, represented as a factor graph.","data":{"altTextIsAutoGenerated":true},"key":"Sf6JsOOcGN","urlSource":"_static/Tutorial/2_hmm-FG.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 2","identifier":"figure 2","html_id":"figure-2","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"xdd3vQJgc8"},{"type":"text","value":"2","key":"lqLiImkofn"},{"type":"text","value":":","key":"bJPoFN10gl"}],"template":"Figure %s:","key":"HAfjM96Mzv"},{"type":"text","value":"An HMM with observed measurements, unrolled over time, represented as a factor graph.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"k3Nblyjrmb"}],"key":"OlsQEz5geE"}],"key":"FAdogCz4Lx"}],"label":"Figure 2","identifier":"figure 2","enumerator":"2","html_id":"figure-2","key":"oBaXk1C4no"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"This motivates a different graphical model, a ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"LGXVdICZpM"},{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"factor graph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"azzqWB6gOL"}],"key":"ADC62aDonk"},{"type":"text","value":", in which we only represent the unknown variables ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Xs9Rv70FN0"},{"type":"inlineMath","value":"X_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">X_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YMVM1JjpBy"},{"type":"text","value":", ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"R7UinnOKNN"},{"type":"inlineMath","value":"X_2","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">X_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zsUWVwwyHd"},{"type":"text","value":", and ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"GC67Ow5xbE"},{"type":"inlineMath","value":"X_3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">X_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"t1gVl1xYb3"},{"type":"text","value":", connected to factors that encode probabilistic information on them, as in Figure 2. To do maximum a-posteriori (MAP) inference, we then maximize the product","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Gdsd1zycp2"}],"key":"wU92KAozmR"},{"type":"math","value":"f(X_1, X_2, X_3) = \\prod f_i(\\mathscr{X}_i)","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo>∏</mo><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"script\">X</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(X_1, X_2, X_3) = \\prod f_i(\\mathscr{X}_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.6em;vertical-align:-0.55em;\"></span><span class=\"mop op-symbol large-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathscr\" style=\"margin-right:0.26006em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2601em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"oaHjcDjXPV"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"i.e., the value of the factor graph. It should be clear from the figure that the connectivity of a factor graph encodes, for each factor ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"N2QopZFLqz"},{"type":"inlineMath","value":"f_i","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HCh5p6b3Uo"},{"type":"text","value":", which subset of variables  ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"caTDew6lGH"},{"type":"inlineMath","value":"(\\mathscr{X}_i","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"script\">X</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">(\\mathscr{X}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathscr\" style=\"margin-right:0.26006em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2601em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cPbbtexKJr"},{"type":"text","value":" it depends on. In the examples below, we use factor graphs to model more complex MAP inference problems in robotics.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"ylJUGfQWF0"}],"key":"BNZgin9FIW"},{"type":"heading","depth":2,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"2. Modeling Robot Motion","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"Np86W7l5xu"}],"identifier":"id-2-modeling-robot-motion","label":"2. Modeling Robot Motion","html_id":"id-2-modeling-robot-motion","implicit":true,"key":"UdDtHgX7kU"},{"type":"heading","depth":3,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"2.1 Modeling with Factor Graphs","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"hDFOzyNyOp"}],"identifier":"id-2-1-modeling-with-factor-graphs","label":"2.1 Modeling with Factor Graphs","html_id":"id-2-1-modeling-with-factor-graphs","implicit":true,"key":"J36kxYKxiv"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Before diving into a SLAM example, let us consider the simpler problem of modeling robot motion. This can be done with a continuous Markov chain, and provides a gentle introduction to GTSAM.","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"HfQt2xkY9P"}],"key":"iYvJnmkWLk"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/3_FactorGraph-65995bbd0039600aeff0617ccee5e130.png","alt":"Factor graph for robot localization.","data":{"altTextIsAutoGenerated":true},"key":"HoPX8johto","urlSource":"_static/Tutorial/3_FactorGraph.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 3","identifier":"figure 3","html_id":"figure-3","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"YJfr206cuB"},{"type":"text","value":"3","key":"FeTdeflSS7"},{"type":"text","value":":","key":"sOqZ3ThSsg"}],"template":"Figure %s:","key":"Vq9Wr9EwnZ"},{"type":"text","value":"Factor graph for robot localization.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"YyNwujJg9l"}],"key":"KzWOfA7I8m"}],"key":"frlnK5xQ2O"}],"label":"Figure 3","identifier":"figure 3","enumerator":"3","html_id":"figure-3","key":"q2S0bJ8OHE"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"The factor graph for a simple example is shown in Figure 3. There are three variables ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"jEsypAADT4"},{"type":"inlineMath","value":"x_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rsD1uEkUjZ"},{"type":"text","value":", ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"Y9l4lE4uLM"},{"type":"inlineMath","value":"x_2","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"q8X3ZfJcwH"},{"type":"text","value":", and ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"Pe33QWw5w3"},{"type":"inlineMath","value":"x_3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GFxHLZ6SEY"},{"type":"text","value":" which represent the poses of the robot over time, rendered in the figure by the open-circle variable nodes. In this example, we have one ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"Tc4E5bhvJ4"},{"type":"strong","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"unary factor","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"G5b9qVeuxq"}],"key":"kPQ5t0O2ho"},{"type":"text","value":" ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"SQic3U64v6"},{"type":"inlineMath","value":"f_0(x_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_0(x_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"pptlYQgvuI"},{"type":"text","value":" on the first pose ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"AJBT7HHwxj"},{"type":"inlineMath","value":"x_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xBylUDoqYt"},{"type":"text","value":" that encodes our prior knowledge about ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"VQTzyXQodE"},{"type":"inlineMath","value":"x_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"C8IdSRiO4C"},{"type":"text","value":", and two ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"cLe8n01G2B"},{"type":"strong","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"binary factors","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"NMKu0h0Sn0"}],"key":"Z69LLf98tb"},{"type":"text","value":" that relate successive poses, respectively ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"UPhk997T3d"},{"type":"inlineMath","value":"f_1(x_1, x_2; o_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">;</mo><msub><mi>o</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_1(x_1, x_2; o_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ST7Rvtt3Fl"},{"type":"text","value":" and ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"rdbaCovX3E"},{"type":"inlineMath","value":"f_2(x_2, x_3; o_2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>3</mn></msub><mo separator=\"true\">;</mo><msub><mi>o</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_2(x_2, x_3; o_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"lpHnhYTYPC"},{"type":"text","value":" where ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"VXz7Qr8LV6"},{"type":"inlineMath","value":"o_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>o</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">o_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LroE9ENGHh"},{"type":"text","value":" and ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"XIw3tk6X1M"},{"type":"inlineMath","value":"o_2","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>o</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">o_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"kifTz7PLvT"},{"type":"text","value":" represent odometry measurements.","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"GNrz94Mz9C"}],"key":"vHZgAfKWeX"},{"type":"heading","depth":3,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"2.2 Creating a Factor Graph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"ws1eIXuGmW"}],"identifier":"id-2-2-creating-a-factor-graph","label":"2.2 Creating a Factor Graph","html_id":"id-2-2-creating-a-factor-graph","implicit":true,"key":"DX2pUdjOxS"},{"type":"paragraph","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"The following C++ code, included in GTSAM as an example, creates the factor graph in Figure 3:","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"DtP3MGZh1j"}],"key":"JuoHqgbrZl"},{"type":"code","lang":"c","showLineNumbers":true,"value":"// Create an empty nonlinear factor graph\nNonlinearFactorGraph graph;\n\n// Add a Gaussian prior on pose x_1\nPose2 priorMean(0.0, 0.0, 0.0);\nnoiseModel::Diagonal::shared_ptr priorNoise =\n  noiseModel::Diagonal::Sigmas(Vector3(0.3, 0.3, 0.1));\ngraph.add(PriorFactor<Pose2>(1, priorMean, priorNoise));\n\n// Add two odometry factors\nPose2 odometry(2.0, 0.0, 0.0);\nnoiseModel::Diagonal::shared_ptr odometryNoise =\n  noiseModel::Diagonal::Sigmas(Vector3(0.2, 0.2, 0.1));\ngraph.add(BetweenFactor<Pose2>(1, 2, odometry, odometryNoise));\ngraph.add(BetweenFactor<Pose2>(2, 3, odometry, odometryNoise));","key":"dsKmNmRiuC"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Above, line 2 creates an empty factor graph. We then add the factor ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"bbKv4Cb1hn"},{"type":"inlineMath","value":"f_0(x_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_0(x_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"GGB607R2Yg"},{"type":"text","value":" on lines 5-8 as an instance of ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"SXZRJoWCsn"},{"type":"inlineCode","value":"PriorFactor<T>","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"OYdtMAfHy7"},{"type":"text","value":", a templated class provided in the slam subfolder, with ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"GGgSxwMSrl"},{"type":"emphasis","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"T=Pose2","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"z0G7KXvEsl"}],"key":"ixoK6hN4Wi"}],"key":"VirS0sUVaM"},{"type":"text","value":". Its constructor takes a variable ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"uPQedZNGOB"},{"type":"emphasis","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Key","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"Ov1b5vyHef"}],"key":"y7Wnls4V4O"}],"key":"zOexavOoBv"},{"type":"text","value":" (in this case 1), a mean of type ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"DDX4Qm2eoL"},{"type":"inlineCode","value":"Pose2","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"bQSYYoBP1W"},{"type":"text","value":", created on Line 5, and a noise model for the prior density. We provide a diagonal Gaussian of type ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"OWnjdUWIfJ"},{"type":"inlineCode","value":"noiseModel::Diagonal","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"wVva0v7F6E"},{"type":"text","value":" by specifying three standard deviations in line 7, respectively 30 cm. on the robot’s position, and 0.1 radians on the robot’s orientation. Note that the ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"PRtaBnPrbQ"},{"type":"emphasis","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Sigmas","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"SH5ABkNspa"}],"key":"m7bSWd6hZm"}],"key":"RBayRGfKyk"},{"type":"text","value":" constructor returns a shared pointer, anticipating that typically the same noise models are used for many different factors.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"t4FWEaavc6"}],"key":"B9X6sQJPDF"},{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Similarly, odometry measurements are specified as ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"ukcFAQ1LEh"},{"type":"emphasis","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"strong","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Pose2","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"s2o6koaXCc"}],"key":"wK38NLpmqq"}],"key":"qg32UtH0f5"},{"type":"text","value":" on line 11, with a slightly different noise model defined on line 12-13. We then add the two factors ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"GMtJqpVwNC"},{"type":"inlineMath","value":"f_1(x_1, x_2; o_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">;</mo><msub><mi>o</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_1(x_1, x_2; o_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"qclEmDbHnN"},{"type":"text","value":" and ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"xDotOQOCA6"},{"type":"inlineMath","value":"f_2(x_2, x_3; o_2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>3</mn></msub><mo separator=\"true\">;</mo><msub><mi>o</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_2(x_2, x_3; o_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"JqZOa525su"},{"type":"text","value":" on lines 14-15, as instances of yet another templated class, ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"PQJ1gpMmfo"},{"type":"emphasis","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"strong","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"BetweenFactor<T>","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"BLTT7By8vA"}],"key":"Nr5F8ZB8F7"}],"key":"Vb9gp52ZwO"},{"type":"text","value":", again with ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"CPWhdhrK4p"},{"type":"emphasis","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"strong","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"T=Pose2","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"BfFTpBjchf"}],"key":"GzrzR4Rwzj"}],"key":"Pja5YaM47K"},{"type":"text","value":".","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"MkhHquCyoV"}],"key":"MzmTrFQM1v"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"When running the example (","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"wf6dQvXHQl"},{"type":"inlineCode","value":"make OdometryExample.run","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"MLLKCQL3vJ"},{"type":"text","value":" on the command prompt), it will print out the factor graph as follows:","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"NOOBgXgw3V"}],"key":"zHePtOt2tv"},{"type":"code","lang":"","value":"Factor Graph:\nsize: 3\nFactor 0: PriorFactor on 1\nprior mean: (0, 0, 0)\nnoise model: diagonal sigmas [0.3; 0.3; 0.1];\nFactor 1: BetweenFactor(1,2)\nmeasured: (2, 0, 0)\nnoise model: diagonal sigmas [0.2; 0.2; 0.1];\nFactor 2: BetweenFactor(2,3)\nmeasured: (2, 0, 0)\nnoise model: diagonal sigmas [0.2; 0.2; 0.1];","position":{"start":{"line":93,"column":1},"end":{"line":103,"column":1}},"key":"MIxqjLGa6A"},{"type":"heading","depth":3,"position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"2.3 Factor Graphs vs. Values","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"uOTJcocML9"}],"identifier":"id-2-3-factor-graphs-vs-values","label":"2.3 Factor Graphs vs. Values","html_id":"id-2-3-factor-graphs-vs-values","implicit":true,"key":"j0hXegaEcq"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"At this point it is instructive to emphasize two important design ideas underlying GTSAM:","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"mGPQDzptoQ"}],"key":"TSIHUDlJxX"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":109,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":109,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"The factor graph and its embodiment in code specify the joint probability distribution ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"IPr7tfqEX2"},{"type":"inlineMath","value":"P(X|Z)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(X|Z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mclose\">)</span></span></span></span>","key":"hVAUGivRls"},{"type":"text","value":" over the ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"y9lXvcLRBd"},{"type":"emphasis","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"entire","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"Drz0s0G91g"}],"key":"LJfko7TagZ"},{"type":"text","value":" trajectory ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"oBb6VCVze4"},{"type":"inlineMath","value":"X = {x_1, x_2, x_3}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo>=</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>3</mn></msub></mrow></mrow><annotation encoding=\"application/x-tex\">X = {x_1, x_2, x_3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"eVDwp48bxx"},{"type":"text","value":" of the robot, rather than just the last pose. This ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"uX5aG1G85P"},{"type":"emphasis","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"smoothing","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"ESC8XZkiFq"}],"key":"pBxQ2vkzgX"},{"type":"text","value":" view of the world gives GTSAM its name: “smoothing and mapping”. Later in this document we will talk about how we can also use GTSAM to do filtering (which you often do ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"axEzWPtbWH"},{"type":"emphasis","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"nc4WZtWRqA"}],"key":"jODj8ZBDcq"},{"type":"text","value":" want to do) or incremental inference (which we do all the time).","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"KLDRgXBUBc"}],"key":"VM4cA3Jyxj"}],"key":"JIpaw7gTje"},{"type":"listItem","spread":true,"position":{"start":{"line":111,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"A factor graph in GTSAM is just the specification of the probability density ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"mfZ85Ey1uS"},{"type":"inlineMath","value":"P(X|Z)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(X|Z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mclose\">)</span></span></span></span>","key":"W0gktPBFGR"},{"type":"text","value":", and the corresponding ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"zpN9psCiL9"},{"type":"emphasis","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"strong","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"FactorGraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"oOj9xnrlxF"}],"key":"isJyEdTte5"}],"key":"GFmgUvBGVW"},{"type":"text","value":" class and its derived classes do not ever contain a “solution”. Rather, there is a separate type ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"kPR1MJrlfc"},{"type":"emphasis","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"strong","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Values","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"d6XARBvVqI"}],"key":"t4FpuGBfjq"}],"key":"AXUSrhKiZA"},{"type":"text","value":" that is used to specify specific values for (in this case) ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"fYSW1eL88o"},{"type":"inlineMath","value":"x_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JNC8cZxhbU"},{"type":"text","value":", ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"lnFLaYbhSH"},{"type":"inlineMath","value":"x_2","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XUxgQ5QnCN"},{"type":"text","value":", and ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"i7lAS62RVw"},{"type":"inlineMath","value":"x_3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BPCV1VyvE6"},{"type":"text","value":", which can then be used to evaluate the probability (or, more commonly, the error) associated with particular values.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"HE9VD8KaXr"}],"key":"zLeZ6fwcUH"}],"key":"fGnh0ExQIz"}],"key":"PCKEhT1hFZ"},{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"The latter point is often a point of confusion with beginning users of GTSAM. It helps to remember that when designing GTSAM we took a functional approach of classes corresponding to mathematical objects, which are usually immutable. You should think of a factor graph as a ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"gwkjB2UL1p"},{"type":"emphasis","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"function","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"rEjJLadl3k"}],"key":"rz6UkYV8Wa"},{"type":"text","value":" to be applied to values—as the notation ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"cQ870TIZiT"},{"type":"inlineMath","value":"f(X) \\propto P(X|Z)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>∝</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(X) \\propto P(X|Z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∝</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mclose\">)</span></span></span></span>","key":"NKA39uvCQQ"},{"type":"text","value":" implies—rather than as an object to be modified.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"NVcW4gQxTf"}],"key":"lLxynqYfZ9"},{"type":"heading","depth":3,"position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"2.4 Non-linear Optimization in GTSAM","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"o4b7U50WF1"}],"identifier":"id-2-4-non-linear-optimization-in-gtsam","label":"2.4 Non-linear Optimization in GTSAM","html_id":"id-2-4-non-linear-optimization-in-gtsam","implicit":true,"key":"l4uUgwsZ5I"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"The listing below creates a ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"o4Z31OVNCx"},{"type":"emphasis","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"strong","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Values","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"rfdQjyYa9f"}],"key":"EVLKuUc6PA"}],"key":"VHmj9pyLpE"},{"type":"text","value":" instance, and uses it as the initial estimate to find the maximum a-posteriori (MAP) assignment for the trajectory ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"ZdHfzXUWaK"},{"type":"inlineMath","value":"X","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>","key":"BLRltZbZp8"},{"type":"text","value":":","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"VP81O56KaJ"}],"key":"T5TIj67pug"},{"type":"code","lang":"c","showLineNumbers":true,"value":"// create (deliberately inaccurate) initial estimate\nValues initial;\ninitial.insert(1, Pose2(0.5, 0.0, 0.2));\ninitial.insert(2, Pose2(2.3, 0.1, -0.2));\ninitial.insert(3, Pose2(4.1, 0.1, 0.1));\n\n// optimize using Levenberg-Marquardt optimization\nValues result = LevenbergMarquardtOptimizer(graph, initial).optimize();","key":"YcHi4fHL3g"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Lines 2-5 in Listing 2.4 create the initial estimate, and on line 8 we create a non-linear Levenberg-Marquardt style optimizer, and call ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"r9dkJsaa22"},{"type":"emphasis","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"optimize","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"WW9cRci2NW"}],"key":"FzhnBfpjMk"}],"key":"D1daUZipYw"},{"type":"text","value":" using default parameter settings. The reason why GTSAM needs to perform non-linear optimization is because the odometry factors ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"gAdUKB1gQr"},{"type":"inlineMath","value":"f_1(x_1, x_2; o_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">;</mo><msub><mi>o</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_1(x_1, x_2; o_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"L0K4DpVPI4"},{"type":"text","value":" and ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"FgVLr0XIH0"},{"type":"inlineMath","value":"f_2(x_2, x_3; o_2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>3</mn></msub><mo separator=\"true\">;</mo><msub><mi>o</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_2(x_2, x_3; o_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"z3TOcshwux"},{"type":"text","value":" are non-linear, as they involve the orientation of the robot. This also explains why the factor graph we created in Listing 2.2 is of type ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"KwKzcrHcAd"},{"type":"emphasis","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"NonlinearFactorGraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"M3UQ4jpZdd"}],"key":"oKvvMN7TfN"}],"key":"FDc6AcFi2k"},{"type":"text","value":". The optimization class linearizes this graph, possibly multiple times, to minimize the non-linear squared error specified by the factors.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"YoiSUyQAtz"}],"key":"LjKTccXAey"},{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"The relevant output from running the example is as follows:","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"dDDjV9BoZH"}],"key":"GYSJ9ppeUF"},{"type":"code","lang":"","value":"Initial Estimate:\nValues with 3 values:\nValue 1: (0.5, 0, 0.2)\nValue 2: (2.3, 0.1, -0.2)\nValue 3: (4.1, 0.1, 0.1)\n\nFinal Result:\nValues with 3 values:\nValue 1: (-1.8e-16, 8.7e-18, -9.1e-19)\nValue 2: (2, 7.4e-18, -2.5e-18)\nValue 3: (4, -1.8e-18, -3.1e-18)","position":{"start":{"line":135,"column":1},"end":{"line":145,"column":1}},"key":"olDPxoZ8xb"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"It can be seen that, subject to very small tolerance, the ground truth solution ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"sqEwA0UuDO"},{"type":"inlineMath","value":"x_1=(0, 0, 0)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_1=(0, 0, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"WhxYdbzXCV"},{"type":"text","value":", ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"Y7VScJCB3I"},{"type":"inlineMath","value":"x_2=(2, 0, 0)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_2=(2, 0, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"xZU7rYJSA4"},{"type":"text","value":", and ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"KKegrk9s6D"},{"type":"inlineMath","value":"x_3=(4, 0, 0)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>4</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_3=(4, 0, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"CXtHE6004l"},{"type":"text","value":" is recovered.","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"ujeo83uerz"}],"key":"LfjROuxPht"},{"type":"heading","depth":3,"position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"2.5 Full Posterior Inference","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"GgkNQ7SDDH"}],"identifier":"id-2-5-full-posterior-inference","label":"2.5 Full Posterior Inference","html_id":"id-2-5-full-posterior-inference","implicit":true,"key":"zcscCUcNHd"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"GTSAM can also be used to calculate the covariance matrix for each pose after incorporating the information from all measurements ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"KzkYJTjVKc"},{"type":"inlineMath","value":"Z","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"wSbnCZ7Zw7"},{"type":"text","value":". Recognizing that the factor graph encodes the ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"dYbUCCDlW6"},{"type":"strong","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"posterior density","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"VQdZw5SMlP"}],"key":"LrW2l3BGZa"},{"type":"text","value":" ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"NqZlPlRzJQ"},{"type":"inlineMath","value":"P(X|Z)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(X|Z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mclose\">)</span></span></span></span>","key":"XBlWPsseMM"},{"type":"text","value":", the mean ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"sIAkxrQKYP"},{"type":"text","value":"μ","key":"vNukIeFvrn"},{"type":"text","value":" together with the covariance ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"iiNp5i04G7"},{"type":"text","value":"Σ","key":"uHt1m5RASx"},{"type":"text","value":" for each pose ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"a2t8cmdvbB"},{"type":"inlineMath","value":"x","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"hbREvlnqYO"},{"type":"text","value":" approximate the ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"Jhzn1P3EKE"},{"type":"strong","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"marginal posterior density","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"b35FXrcQ2O"}],"key":"pW9XXSmrVy"},{"type":"text","value":" ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"tiCLAiMvhb"},{"type":"inlineMath","value":"P(x|Z)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi mathvariant=\"normal\">∣</mi><mi>Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(x|Z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mclose\">)</span></span></span></span>","key":"X711w5844Z"},{"type":"text","value":". Note that this is just an approximation, as even in this simple case the odometry factors are actually non-linear in their arguments, and GTSAM only computes a Gaussian approximation to the true underlying posterior.","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"ycAtjgYsvU"}],"key":"xU9xHyq83R"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"The following C++ code will recover the posterior marginals:","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"MQh6qde4Xq"}],"key":"zSWq1TOMaC"},{"type":"code","lang":"c","showLineNumbers":true,"value":"// Query the marginals\ncout.precision(2);\nMarginals marginals(graph, result);\ncout << \"x1 covariance:\\n\" << marginals.marginalCovariance(1) << endl;\ncout << \"x2 covariance:\\n\" << marginals.marginalCovariance(2) << endl;\ncout << \"x3 covariance:\\n\" << marginals.marginalCovariance(3) << endl;","key":"kqtj1iD0x3"},{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"The relevant output from running the example is as follows:","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"kDDDnM3LPE"}],"key":"C4yqPDgy7O"},{"type":"code","lang":"","value":"x1 covariance:\n    0.09     1.1e-47     5.7e-33\n    1.1e-47        0.09     1.9e-17\n    5.7e-33     1.9e-17        0.01\nx2 covariance:\n    0.13     4.7e-18     2.4e-18\n    4.7e-18        0.17        0.02\n    2.4e-18        0.02        0.02\nx3 covariance:\n    0.17     2.7e-17     8.4e-18\n    2.7e-17        0.37        0.06\n    8.4e-18        0.06        0.03","position":{"start":{"line":167,"column":1},"end":{"line":178,"column":1}},"key":"NdSuLpm9jW"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"What we see is that the marginal covariance ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"S7X5QPpXLd"},{"type":"inlineMath","value":"P(x_1|Z)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mi mathvariant=\"normal\">∣</mi><mi>Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(x_1|Z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mclose\">)</span></span></span></span>","key":"kLBGo6IE7T"},{"type":"text","value":" on ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"JWaxqNEUbT"},{"type":"inlineMath","value":"x_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rwiPEUX87Z"},{"type":"text","value":" is simply the prior knowledge on ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"Wqj5wHyPfo"},{"type":"inlineMath","value":"x_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Fq95Dzwsn7"},{"type":"text","value":", but as the robot moves the uncertainty in all dimensions grows without bound, and the ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"uEDsmw1Pln"},{"type":"inlineMath","value":"y","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"yaDhxnwwRt"},{"type":"text","value":" and ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"h4z1dkbQQy"},{"type":"text","value":"θ","key":"i8F1DCxqOZ"},{"type":"text","value":" components of the pose become (positively) correlated.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"OZ9Qf9Y0E5"}],"key":"HYAZaH9cYe"},{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"An important fact to note when interpreting these numbers is that covariance matrices are given in ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"ZBgEHYkc6x"},{"type":"emphasis","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"relative","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"absWJyysKY"}],"key":"lutgyY8kss"},{"type":"text","value":" coordinates, not absolute coordinates. This is because internally GTSAM optimizes for a change with respect to a linearization point, as do all nonlinear optimization libraries.","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"dCqWReLE2S"}],"key":"Uj2Z44to0n"},{"type":"heading","depth":2,"position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"3. Robot Localization","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"bAr3LjnoLk"}],"identifier":"id-3-robot-localization","label":"3. Robot Localization","html_id":"id-3-robot-localization","implicit":true,"key":"O68Zo9W2XV"},{"type":"heading","depth":3,"position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"3.1 Unary Measurement Factors","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"h44dgy58Ul"}],"identifier":"id-3-1-unary-measurement-factors","label":"3.1 Unary Measurement Factors","html_id":"id-3-1-unary-measurement-factors","implicit":true,"key":"WfndFv5h9P"},{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"In this section we add measurements to the factor graph that will help us actually ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"ucNf3xb2SV"},{"type":"emphasis","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"localize","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"XPHS38NhDJ"}],"key":"guawSzyuXs"},{"type":"text","value":" the robot over time. The example also serves as a tutorial on creating new factor types.","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"CBPrCPOPpo"}],"key":"nAOODzHskY"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/4_FactorGraph2-0f1bc0f1b65dedd419f1b2014282856a.png","alt":"Robot localization factor graph with unary measurement factors at each time step.","data":{"altTextIsAutoGenerated":true},"key":"QUuLUaS6g7","urlSource":"_static/Tutorial/4_FactorGraph2.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 4","identifier":"figure 4","html_id":"figure-4","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"EThZ1DXmoN"},{"type":"text","value":"4","key":"yKpnU5QIt1"},{"type":"text","value":":","key":"p5crV2mybS"}],"template":"Figure %s:","key":"cVBEFQ6fTk"},{"type":"text","value":"Robot localization factor graph with unary measurement factors at each time step.","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"bekkD5QPPo"}],"key":"H65BUUjwOz"}],"key":"bU1T0YLNXq"}],"label":"Figure 4","identifier":"figure 4","enumerator":"4","html_id":"figure-4","key":"BT7Mrt62jC"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"In particular, we use ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"nqlTpAS5ls"},{"type":"strong","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"unary measurement factors","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"zVpwgY4dkI"}],"key":"hQvnhZWOpC"},{"type":"text","value":" to handle external measurements. The example from Section 2 is not very useful on a real robot, because it only contains factors corresponding to odometry measurements. These are imperfect and will lead to quickly accumulating uncertainty on the last robot pose, at least in the absence of any external measurements (see Section 2.5). Figure 4 shows a new factor graph where the prior ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"YDZMhJ18eA"},{"type":"inlineMath","value":"f_0(x_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_0(x_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"i1zlPlEPdZ"},{"type":"text","value":" is omitted and instead we added three unary factors ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"lYYr8V91zc"},{"type":"inlineMath","value":"f_1(x_1; z_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">;</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_1(x_1; z_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"BsXTRHEluq"},{"type":"text","value":", ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"qUFE85sZCu"},{"type":"inlineMath","value":"f_2(x_2; z_2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">;</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_2(x_2; z_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"dZNYYoyYbY"},{"type":"text","value":", ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"yIzB9I61CT"},{"type":"inlineMath","value":"f_3(x_3; z_3)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>3</mn></msub><mo separator=\"true\">;</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_3(x_3; z_3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"cZIgSShLjK"},{"type":"text","value":" one for each localization measurement ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"dWsYuihkG3"},{"type":"inlineMath","value":"z_t","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">z_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"eZztTm8R7h"},{"type":"text","value":", respectively. Such unary factors are applicable for measurements ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"jyOvUFpmKn"},{"type":"inlineMath","value":"z_t","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">z_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"spskDi0wzJ"},{"type":"text","value":"that depend ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"c4tbYw8n35"},{"type":"emphasis","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"only","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"IP9Pra8lDY"}],"key":"a4bl6Jeoc1"},{"type":"text","value":" on the current robot pose, e.g., GPS readings, correlation of a laser range-finder in a pre-existing map, or indeed the presence of absence of ceiling lights (see ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"fQluySNCCQ"},{"type":"cite","kind":"narrative","label":"Dellaert1999","identifier":"dellaert1999","children":[{"type":"text","value":"Dellaert & Thrun (1999)","key":"RbJk5xKe6n"}],"enumerator":"3","key":"NmnYcu3CYJ"},{"type":"text","value":" for that amusing example).","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"OqciT2FjUb"}],"key":"tvpBnTojgf"},{"type":"heading","depth":3,"position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"3.2 Defining Custom Factors","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"LlyUSdW3QK"}],"identifier":"id-3-2-defining-custom-factors","label":"3.2 Defining Custom Factors","html_id":"id-3-2-defining-custom-factors","implicit":true,"key":"UQUGrcPlR9"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"In GTSAM, you can create custom unary factors by deriving a new class from the built-in class ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"PucciPitju"},{"type":"emphasis","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"strong","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"NoiseModelFactor1<T>","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"nT2XeWHAbR"}],"key":"PFe7tAjXG5"}],"key":"NKn2uIfUhS"},{"type":"text","value":", which implements a unary factor corresponding to a measurement likelihood with a Gaussian noise model, ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"NU0s0MHtk5"},{"type":"inlineMath","value":"L(q; m) = \\exp \\left\\{ -\\frac{1}{2} \\| h(q) - m \\|^2_{\\Sigma} \\right\\} = f(q)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo separator=\"true\">;</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">{</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant=\"normal\">∥</mi><mi>h</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>m</mi><msubsup><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"normal\">Σ</mi><mn>2</mn></msubsup><mo fence=\"true\">}</mo></mrow><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(q; m) = \\exp \\left\\{ -\\frac{1}{2} \\| h(q) - m \\|^2_{\\Sigma} \\right\\} = f(q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">{</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4247em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">Σ</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">}</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span></span></span></span>","key":"Ad3aQE8sC2"},{"type":"text","value":" where ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"q60z9TV3xt"},{"type":"inlineMath","value":"m","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"NWXArWoIZV"},{"type":"text","value":" is the measurement, ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"bjmwIySB25"},{"type":"inlineMath","value":"q","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"YbrRBHz2Ll"},{"type":"text","value":" is the unknown variable, ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"LfPqVb5Anp"},{"type":"inlineMath","value":"h(q)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h(q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span></span></span></span>","key":"ppYEDXuCMJ"},{"type":"text","value":" is a (possibly nonlinear) measurement function, and ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"hVDOUc7S7X"},{"type":"text","value":"Σ","key":"AypwpYVxpe"},{"type":"text","value":" is the noise covariance. Note that ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"eyXVMsmZAK"},{"type":"inlineMath","value":"m","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"hhGXWC23d5"},{"type":"text","value":" is considered ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"LjFBUwwChD"},{"type":"emphasis","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"known","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"H6EXV7jrVj"}],"key":"QQpFWyIfGf"},{"type":"text","value":" above, and the likelihood ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"wlU54Dc2Nr"},{"type":"inlineMath","value":"L(q; m)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo separator=\"true\">;</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(q; m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>","key":"cSDcmFEasv"},{"type":"text","value":" will only ever be evaluated as a function of ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"JW3jCYOqI8"},{"type":"inlineMath","value":"q","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"zuO9z4unTj"},{"type":"text","value":", which explains why it is a unary factor ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"ayZ0Sju3Ud"},{"type":"inlineMath","value":"f(q)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span></span></span></span>","key":"NXAS3rfMre"},{"type":"text","value":". It is always the unknown variable ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"lkt7rQZzzE"},{"type":"inlineMath","value":"q","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"OOWlF9sxsB"},{"type":"text","value":" that is either likely or unlikely, given the measurement.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"kITx0OhA7A"}],"key":"J8G8jN2TX7"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"RareyhlzFU"}],"key":"Xqo9FAzsQC"},{"type":"paragraph","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"children":[{"type":"text","value":"Many people get this backwards, often misled by the conditional density notation ","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"xqSbPkxkOm"},{"type":"inlineMath","value":"P(m|q)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mi mathvariant=\"normal\">∣</mi><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(m|q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span></span></span></span>","key":"rZT0NCnwWl"},{"type":"text","value":".","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"GIsVosVlj8"}],"key":"hJBbLm5NuT"},{"type":"paragraph","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"In fact, the likelihood ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"ap6b7y4ndr"},{"type":"inlineMath","value":"L(q; m)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo separator=\"true\">;</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(q; m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>","key":"C4jWW83yQg"},{"type":"text","value":" is ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"mNIBrf683o"},{"type":"emphasis","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"defined","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"bc8god7WSv"}],"key":"r3cN6cq79b"},{"type":"text","value":" as any function of ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"CBp2y3pyKE"},{"type":"inlineMath","value":"q","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"otVJh9I1FC"},{"type":"text","value":" proportional to ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"Nuz9yTBsG2"},{"type":"inlineMath","value":"P(m|q)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mi mathvariant=\"normal\">∣</mi><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(m|q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span></span></span></span>","key":"xJHwxAGj6K"},{"type":"text","value":".","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"P1LdbGms15"}],"key":"QsmR83CSgt"}],"key":"kX0KtWN0N2"},{"type":"paragraph","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"Listing 3.2 shows an example on how to define the custom factor class ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"s4V6T6jXGS"},{"type":"emphasis","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"strong","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"UnaryFactor","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"DMjRYTlUQ2"}],"key":"EzkHqvrLwC"}],"key":"hyoCNnK4UD"},{"type":"text","value":" which implements a “GPS-like” measurement likelihood:","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"KNFA2Q6XmM"}],"key":"YXFHnGWdyn"},{"type":"code","lang":"c","showLineNumbers":true,"value":"class UnaryFactor: public NoiseModelFactor1<Pose2> {\n  double mx_, my_; ///< X and Y measurements\n\npublic:\n  UnaryFactor(Key j, double x, double y, const SharedNoiseModel& model):\n    NoiseModelFactor1<Pose2>(model, j), mx_(x), my_(y) {}\n\n  Vector evaluateError(const Pose2& q,\n                       boost::optional<Matrix&> H = boost::none) const\n  {\n    const Rot2& R = q.rotation();\n    if (H) (*H) = (gtsam::Matrix(2, 3) <<\n            R.c(), -R.s(), 0.0,\n            R.s(), R.c(), 0.0).finished();\n    return (Vector(2) << q.x() - mx_, q.y() - my_).finished();\n  }\n};","key":"CSNBfcAewD"},{"type":"paragraph","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"In defining the derived class on line 1, we provide the template argument ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"kj7xRA9V6E"},{"type":"emphasis","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"strong","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"Pose2","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"pk40HKX1b5"}],"key":"f2GqiGoh11"}],"key":"slJH7Z8gUq"},{"type":"text","value":" to indicate the type of the variable ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"OREsfpfcsZ"},{"type":"inlineMath","value":"q","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"eoQ2yVD5RK"},{"type":"text","value":", whereas the measurement is stored as the instance variables ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"FYZoNZ2Gy2"},{"type":"inlineCode","value":"mx_","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"Uo8GgfppD7"},{"type":"text","value":" and ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"MoMG8N8Sz3"},{"type":"inlineCode","value":"my_","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"UvngqOTesi"},{"type":"text","value":", defined on line 2. The constructor on lines 5-6 simply passes on the variable key ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"EtkQqbIJSX"},{"type":"inlineMath","value":"j","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"z5Nv4VHc6j"},{"type":"text","value":" and the noise model to the superclass, and stores the measurement values provided. The most important function to has be implemented by every factor class is ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"Pv4CMvrlbV"},{"type":"inlineCode","value":"evaluateError()","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"V14VpzKgvc"},{"type":"text","value":", which should return ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"hfvepDtl9z"},{"type":"inlineMath","value":"E(q) = h(q) - m","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">E(q) = h(q) - m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"IKb90bNJ4P"},{"type":"text","value":" which is done on line 12. Importantly, because we want to use this factor for nonlinear optimization (see e.g., ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"RZWoEZtIUn"},{"type":"cite","kind":"narrative","label":"KaessDellaert2009","identifier":"kaessdellaert2009","children":[{"type":"text","value":"Kaess & Dellaert (2009)","key":"muCx7kyqIx"}],"enumerator":"4","key":"mLxkiCtoXT"},{"type":"text","value":" for details), whenever the optional argument ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"DodOID0812"},{"type":"inlineMath","value":"H","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"NAs9vXjrN6"},{"type":"text","value":" is provided, a ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"UKwOEugPA4"},{"type":"emphasis","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"strong","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"Matrix","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"GlPNmUohul"}],"key":"XfTZpyxhg5"}],"key":"VKDXgA5mzl"},{"type":"text","value":" reference, the function should assign the ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"LhtXL1KZRr"},{"type":"emphasis","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"strong","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"Jacobian","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"TY13zgMgT5"}],"key":"DLCG62CPsF"}],"key":"psBVVGM1vO"},{"type":"text","value":" of ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"zlIyca32Gt"},{"type":"inlineMath","value":"h(q)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h(q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span></span></span></span>","key":"j03p8m8yKU"},{"type":"text","value":", evauated at the provided value for ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"YMJHAHfavs"},{"type":"inlineMath","value":"q","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"xeoCNxSsDB"},{"type":"text","value":". This is done for this example on line 11. In this case, the Jacobian of the 2-dimensional function ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"yrynSb0rqk"},{"type":"inlineMath","value":"h","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"xjxgNWEe7x"},{"type":"text","value":", which just returns the position of the robot,","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"ZBXkBCmyxN"}],"key":"GclfIOGq5z"},{"type":"math","value":"h(q) = \\begin{bmatrix} q_x \\\\ q_y \\end{bmatrix}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>q</mi><mi>x</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>q</mi><mi>y</mi></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">h(q) = \\begin{bmatrix} q_x \\\\ q_y \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"3","key":"VVLBzsq914"},{"type":"paragraph","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"with respect the 3-dimensional pose ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"PmdijTYinj"},{"type":"inlineMath","value":"q = (q_x, q_y, q_\\theta)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>x</mi></msub><mo separator=\"true\">,</mo><msub><mi>q</mi><mi>y</mi></msub><mo separator=\"true\">,</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q = (q_x, q_y, q_\\theta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"wK8ltGo2jm"},{"type":"text","value":", yields the following ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"qZf85IjDuD"},{"type":"inlineMath","value":"2 \\times 3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">2 \\times 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"AYSw2DQQT6"},{"type":"text","value":" matrix:","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"Afsygl3Mi0"}],"key":"hkWmKfUh30"},{"type":"math","value":"H = \n\\begin{bmatrix}\n\\cos(q_\\theta) & -\\sin(q_\\theta) & 0 \\\\\n\\sin(q_\\theta) & \\cos(q_\\theta) & 0\n\\end{bmatrix}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>H</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">H = \n\\begin{bmatrix}\n\\cos(q_\\theta) &amp; -\\sin(q_\\theta) &amp; 0 \\\\\n\\sin(q_\\theta) &amp; \\cos(q_\\theta) &amp; 0\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"4","key":"UoipRTovvu"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important","key":"r8BkhxVnOj"}],"key":"TsURTCfpG2"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"Many of our users, when attempting to create a custom factor, are initially surprised at the Jacobian matrix not agreeing with their intuition. For example, above you might simply expect a ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"XeovQVHGh6"},{"type":"inlineMath","value":"2 \\times 3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">2 \\times 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"Si3xq4URMa"},{"type":"text","value":" diagonal matrix. This ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"bGg7NEBwH8"},{"type":"emphasis","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"would","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"CWiuvIF7t5"}],"key":"VjovgKAdK8"},{"type":"text","value":" be true for variables belonging to a vector space. However, in GTSAM we define the Jacobian more generally to be the matrix ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"XYh4DsjvJa"},{"type":"inlineMath","value":"H","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"efboUTkusm"},{"type":"text","value":" such that","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"Sxbrle0kmP"}],"key":"gAYXdmpm34"},{"type":"math","value":"h(q e^\\xi) \\approx h(q) + H \\xi","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>q</mi><msup><mi>e</mi><mi>ξ</mi></msup><mo stretchy=\"false\">)</mo><mo>≈</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>H</mi><mi>ξ</mi></mrow><annotation encoding=\"application/x-tex\">h(q e^\\xi) \\approx h(q) + H \\xi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04601em;\">ξ</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal\" style=\"margin-right:0.04601em;\">ξ</span></span></span></span></span>","enumerator":"5","key":"Y82Zw3zsd7"},{"type":"paragraph","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"j94jiUgX2S"},{"type":"inlineMath","value":"\\xi = (\\delta x, \\delta y, \\delta \\theta)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ξ</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>δ</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>δ</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>δ</mi><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\xi = (\\delta x, \\delta y, \\delta \\theta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04601em;\">ξ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">δy</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span></span>","key":"gAPUqJHzsx"},{"type":"text","value":" is an incremental update and ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"WXymTjQxKq"},{"type":"inlineMath","value":"\\mathrm{exp}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">x</mi><mi mathvariant=\"normal\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathrm{exp}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">exp</span></span></span></span></span>","key":"aYV7XckP57"},{"type":"text","value":" ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"h0xkAyHpS5"},{"type":"inlineMath","value":"\\hat{\\xi}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>ξ</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\xi}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1523em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04601em;\">ξ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1389em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"KV3GLMIUwo"},{"type":"text","value":" is the ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"xnPKuT5FpZ"},{"type":"strong","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"exponential map","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"jBaLSTUe1p"}],"key":"PlS8W0ueZh"},{"type":"text","value":" for the variable we want to update, In this case ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"WBIdmwmcqC"},{"type":"inlineMath","value":"q \\in SE(2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo>∈</mo><mi>S</mi><mi>E</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q \\in SE(2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">SE</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"D05F8n0KY7"},{"type":"text","value":", where ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"b80yHFMfJ8"},{"type":"inlineMath","value":"SE(2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>E</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">SE(2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">SE</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"y6pLMIIwbw"},{"type":"text","value":" is the group of 2D rigid transforms, implemented by ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"nvRUUz328n"},{"type":"emphasis","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"strong","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"Pose2","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"Y3yVpoggU5"}],"key":"OFW1Dffv1Z"}],"key":"k7nl3OHkzX"},{"type":"text","value":". The exponential map for ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"nFn0U9ox6U"},{"type":"inlineMath","value":"SE(2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>E</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">SE(2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">SE</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"rwn9yJ1UVY"},{"type":"text","value":" can be approximated to first order as","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"a8eZPXKgpw"}],"key":"aP6F7eXKaV"},{"type":"math","value":"\\exp \\hat{\\xi} \\approx \n\\begin{bmatrix}\n1 & -\\delta\\theta & \\delta x \\\\\n\\delta\\theta & 1 & \\delta y \\\\\n0 & 0 & 1\n\\end{bmatrix}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>exp</mi><mo>⁡</mo><mover accent=\"true\"><mi>ξ</mi><mo>^</mo></mover><mo>≈</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>δ</mi><mi>θ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>δ</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>δ</mi><mi>θ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>δ</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\exp \\hat{\\xi} \\approx \n\\begin{bmatrix}\n1 &amp; -\\delta\\theta &amp; \\delta x \\\\\n\\delta\\theta &amp; 1 &amp; \\delta y \\\\\n0 &amp; 0 &amp; 1\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1523em;vertical-align:-0.1944em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04601em;\">ξ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1389em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">δy</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"o6FMecnl2F"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"when using the ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"afmOF3ARz9"},{"type":"inlineMath","value":"3 \\times 3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3 \\times 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"m4GNm4GDJV"},{"type":"text","value":" matric representation for 2D poses, and hence","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"YQozMn8bfl"}],"key":"BkBAYNzCl8"},{"type":"math","value":"h \\left( q e^\\xi \\right) \\approx \nh \\left( \n\\begin{bmatrix}\n\\cos(q_\\theta) & -\\sin(q_\\theta) & q_x \\\\\n\\sin(q_\\theta) & \\cos(q_\\theta) & q_y \\\\\n0 & 0 & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n1 & -\\delta\\theta & \\delta x \\\\\n\\delta\\theta & 1 & \\delta y \\\\\n0 & 0 & 1\n\\end{bmatrix}\n\\right)\n=\n\\begin{bmatrix}\nq_x + \\cos(q_\\theta) \\delta x - \\sin(q_\\theta) \\delta y \\\\\nq_y + \\sin(q_\\theta) \\delta x + \\cos(q_\\theta) \\delta y\n\\end{bmatrix}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>h</mi><mrow><mo fence=\"true\">(</mo><mi>q</mi><msup><mi>e</mi><mi>ξ</mi></msup><mo fence=\"true\">)</mo></mrow><mo>≈</mo><mi>h</mi><mrow><mo fence=\"true\">(</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>q</mi><mi>x</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>q</mi><mi>y</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>δ</mi><mi>θ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>δ</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>δ</mi><mi>θ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>δ</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo fence=\"true\">)</mo></mrow><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>q</mi><mi>x</mi></msub><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo><mi>δ</mi><mi>x</mi><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo><mi>δ</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>q</mi><mi>y</mi></msub><mo>+</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo><mi>δ</mi><mi>x</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>q</mi><mi>θ</mi></msub><mo stretchy=\"false\">)</mo><mi>δ</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">h \\left( q e^\\xi \\right) \\approx \nh \\left( \n\\begin{bmatrix}\n\\cos(q_\\theta) &amp; -\\sin(q_\\theta) &amp; q_x \\\\\n\\sin(q_\\theta) &amp; \\cos(q_\\theta) &amp; q_y \\\\\n0 &amp; 0 &amp; 1\n\\end{bmatrix}\n\\begin{bmatrix}\n1 &amp; -\\delta\\theta &amp; \\delta x \\\\\n\\delta\\theta &amp; 1 &amp; \\delta y \\\\\n0 &amp; 0 &amp; 1\n\\end{bmatrix}\n\\right)\n=\n\\begin{bmatrix}\nq_x + \\cos(q_\\theta) \\delta x - \\sin(q_\\theta) \\delta y \\\\\nq_y + \\sin(q_\\theta) \\delta x + \\cos(q_\\theta) \\delta y\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2491em;vertical-align:-0.35em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04601em;\">ξ</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎝</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.875em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.875em' height='0.016em' style='width:0.875em' viewBox='0 0 875 16' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V16 H291z M291 0 H417 V16 H291z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎛</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">δy</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.016em' style='width:0.6667em' viewBox='0 0 666.67 16' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎠</span></span></span><span style=\"top:-3.397em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.016em;width:0.875em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.875em' height='0.016em' style='width:0.875em' viewBox='0 0 875 16' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V16 H457z M457 0 H583 V16 H457z'/></svg></span></span><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">δy</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">δy</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"7","key":"eiM5S9fewR"},{"type":"paragraph","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"text","value":"which then explains the Jacobian ","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"hn6NZu3uiQ"},{"type":"inlineMath","value":"H","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"cXf3fp0UEc"},{"type":"text","value":".","position":{"start":{"line":289,"column":1},"end":{"line":289,"column":1}},"key":"pCr3jXXJoc"}],"key":"nuDJ0PVwWv"}],"key":"H8a7c7Zq5D"},{"type":"heading","depth":3,"position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"3.3 Using Custom Factors","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"rSzFg7ver9"}],"identifier":"id-3-3-using-custom-factors","label":"3.3 Using Custom Factors","html_id":"id-3-3-using-custom-factors","implicit":true,"key":"uJDZ7OPQ6w"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"The following C++ code fragment illustrates how to create and add custom factors to a factor graph:","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"w6EB7xHUWP"}],"key":"Ti66ZajQ1I"},{"type":"code","lang":"c","showLineNumbers":true,"value":"// add unary measurement factors, like GPS, on all three poses\nnoiseModel::Diagonal::shared_ptr unaryNoise =\n noiseModel::Diagonal::Sigmas(Vector2(0.1, 0.1)); // 10cm std on x,y\ngraph.add(boost::make_shared<UnaryFactor>(1, 0.0, 0.0, unaryNoise));\ngraph.add(boost::make_shared<UnaryFactor>(2, 2.0, 0.0, unaryNoise));\ngraph.add(boost::make_shared<UnaryFactor>(3, 4.0, 0.0, unaryNoise));","key":"kqjBHpr92z"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"In Listing 3.3, we create the noise model on line 2-3, which now specifies two standard deviations on the measurements ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"rIVsqij9Gf"},{"type":"inlineMath","value":"m_x","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">m_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ejLrp6oTa5"},{"type":"text","value":" and ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"xj3bNhOAe2"},{"type":"inlineMath","value":"m_y","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">m_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"p8ECDPSue0"},{"type":"text","value":". On lines 4-6 we create ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"czWXufKdBQ"},{"type":"inlineCode","value":"shared_ptr","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"o6vNz3DLbO"},{"type":"text","value":" versions of three newly created ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"GmtyuFjd77"},{"type":"inlineCode","value":"UnaryFactor","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"hceYYSYRiM"},{"type":"text","value":" instances, and add them to graph. GTSAM uses shared pointers to refer to factors in factor graphs, and ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"uzf9gfFJUs"},{"type":"inlineCode","value":"boost::make_shared","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"LuVuvICiqb"},{"type":"text","value":" is a convenience function to simultaneously construct a class and create a ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"DZURVIe1Jr"},{"type":"inlineCode","value":"shared_ptr","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"U1baHnjH4n"},{"type":"text","value":" to it. We obtain the factor graph from Figure 4.","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"oQLiRgYOcz"}],"key":"L7kDFBdawR"},{"type":"heading","depth":3,"position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"3.4 Full Posterior Inference","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"HiyLWtrkFl"}],"identifier":"id-3-4-full-posterior-inference","label":"3.4 Full Posterior Inference","html_id":"id-3-4-full-posterior-inference","implicit":true,"key":"MGgPC4kvhW"},{"type":"paragraph","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"The three GPS factors are enough to fully constrain all unknown poses and tie them to a “global” reference frame, including the three unknown orientations. If not, GTSAM would have exited with a singular matrix exception. The marginals can be recovered exactly as in Section 2.5, and the solution and marginal covariances are now given by the following:","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"sWqZBm2MIx"}],"key":"CMVHnjmHy2"},{"type":"code","lang":"","value":"Final Result:\nValues with 3 values:\nValue 1: (-1.5e-14, 1.3e-15, -1.4e-16)\nValue 2: (2, 3.1e-16, -8.5e-17)\nValue 3: (4, -6e-16, -8.2e-17)\n\nx1 covariance:\n    0.0083      4.3e-19     -1.1e-18\n    4.3e-19       0.0094      -0.0031\n    -1.1e-18      -0.0031       0.0082\nx2 covariance:\n    0.0071      2.5e-19     -3.4e-19\n    2.5e-19       0.0078      -0.0011\n    -3.4e-19      -0.0011       0.0082\nx3 covariance:\n    0.0083     4.4e-19     1.2e-18\n    4.4e-19      0.0094      0.0031\n    1.2e-18      0.0031       0.018","position":{"start":{"line":312,"column":1},"end":{"line":329,"column":1}},"key":"CKHHPxTCbe"},{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"Comparing this with the covariance matrices in Section 2.5, we can see that the uncertainty no longer grows without bounds as measurement uncertainty accumulates. Instead, the “GPS” measurements more or less constrain the poses evenly, as expected.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"aOS7cwAw26"}],"key":"JDlBHDdy6H"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/5_Odometry-97e74132e26a5c6ac15cd27533939ab8.png","alt":"Comparing the marginals resulting from the “odometry” factor graph in Figure 3 and the “localization” factor graph in Figure 4.","data":{"altTextIsAutoGenerated":true},"key":"DK6nk4QgLf","urlSource":"_static/Tutorial/5_Odometry.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 5: Odometry marginals","identifier":"figure 5: odometry marginals","html_id":"figure-5-odometry-marginals","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"atvtWH0Kbu"},{"type":"text","value":"5","key":"GAvc9KHiat"},{"type":"text","value":":","key":"Tg2qyUshuS"}],"template":"Figure %s:","key":"DduCXYEIkB"},{"type":"text","value":"Comparing the marginals resulting from the “odometry” factor graph in Figure 3 and the “localization” factor graph in Figure 4.","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"lpRJXyM37B"}],"key":"WsoHJc5O6P"}],"key":"w0ivehiCzd"}],"label":"Figure 5: Odometry marginals","identifier":"figure 5: odometry marginals","enumerator":"5","html_id":"figure-5-odometry-marginals","key":"J6BW7vq5Ln"},{"type":"image","url":"/5_Localization-f0057d7188b14db91316277cdec32b2b.png","key":"de9Oz3IXFt","urlSource":"_static/Tutorial/5_Localization.png"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"Localization Marginals","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"EN2lrl4Z27"}],"key":"bQSUtwa7Dd"},{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"It helps a lot when we view this graphically, as in Figure 5, where I show the marginals on position as 5-sigma covariance ellipses that contain 99.9996% of all probability mass. For the odometry marginals, it is immediately apparent from the figure that (1) the uncertainty on pose keeps growing, and (2) the uncertainty on angular odometry translates into increasing uncertainty on y. The localization marginals, in contrast, are constrained by the unary factors and are all much smaller. In addition, while less apparent, the uncertainty on the middle pose is actually smaller as it is constrained by odometry from two sides.\nYou might now be wondering how we produced these figures. The answer is via the MATLAB interface of GTSAM, which we will demonstrate in the next section.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"eijpsG0yec"}],"key":"KJJQYIiSc6"},{"type":"heading","depth":2,"position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"children":[{"type":"text","value":"4. PoseSLAM","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"nDbWShUaaB"}],"identifier":"id-4-poseslam","label":"4. PoseSLAM","html_id":"id-4-poseslam","implicit":true,"key":"qJbiuesLxN"},{"type":"heading","depth":3,"position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"4.1 Loop Closure Constraints","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"key":"RJVcFf8wu3"}],"identifier":"id-4-1-loop-closure-constraints","label":"4.1 Loop Closure Constraints","html_id":"id-4-1-loop-closure-constraints","implicit":true,"key":"th7VJR5261"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"The simplest instantiation of a SLAM problem is ","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"ZaqFbvrX6m"},{"type":"strong","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"PoseSLAM","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"ryJNnEDcQd"}],"key":"Vgh9SIFNxV"},{"type":"text","value":", which avoids building an explicit map of the environment. The goal of SLAM is to simultaneously localize a robot and map the environment given incoming sensor measurements (","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"insQUxQaw9"},{"type":"cite","kind":"narrative","label":"DurrantWhyteBailey2006","identifier":"durrantwhytebailey2006","children":[{"type":"text","value":"Durrant-Whyte & Bailey (2006)","key":"EbOBB4pTg4"}],"enumerator":"5","key":"gSpkUg3Tzl"},{"type":"text","value":"). Besides wheel odometry, one of the most popular sensors for robots moving on a plane is a 2D laser-range finder, which provides both odometry constraints between successive poses, and loop-closure constraints when the robot re-visits a previously explored part of the environment.","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"ntCJlhfZF0"}],"key":"C5rw8lIyT3"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/6_FactorGraph3-1358917faa372db77ab4c0f0cfe4758f.png","alt":"Factor graph for PoseSLAM.","data":{"altTextIsAutoGenerated":true},"key":"maYLvx5v73","urlSource":"_static/Tutorial/6_FactorGraph3.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 6","identifier":"figure 6","html_id":"figure-6","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"gXUtTmjDHv"},{"type":"text","value":"6","key":"pV6aX6nZtX"},{"type":"text","value":":","key":"GAtZoz1ujz"}],"template":"Figure %s:","key":"t4AIaVSZXq"},{"type":"text","value":"Factor graph for PoseSLAM.","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"NBUIP2AUnS"}],"key":"GtXrwOrABA"}],"key":"Lc8ENw9NvU"}],"label":"Figure 6","identifier":"figure 6","enumerator":"6","html_id":"figure-6","key":"LXtD2OXZSW"},{"type":"paragraph","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"children":[{"type":"text","value":"A factor graph example for PoseSLAM is shown in Figure 6. The following C++ code, included in GTSAM as an example, creates this factor graph in code:","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"m9tv42hC5Q"}],"key":"w3UlWCJ1J2"},{"type":"code","lang":"c","showLineNumbers":true,"value":"NonlinearFactorGraph graph;\nnoiseModel::Diagonal::shared_ptr priorNoise =\n  noiseModel::Diagonal::Sigmas(Vector3(0.3, 0.3, 0.1));\ngraph.add(PriorFactor<Pose2>(1, Pose2(0, 0, 0), priorNoise));\n\n// Add odometry factors\nnoiseModel::Diagonal::shared_ptr model =\n  noiseModel::Diagonal::Sigmas(Vector3(0.2, 0.2, 0.1));\ngraph.add(BetweenFactor<Pose2>(1, 2, Pose2(2, 0, 0     ), model));\ngraph.add(BetweenFactor<Pose2>(2, 3, Pose2(2, 0, M_PI_2), model));\ngraph.add(BetweenFactor<Pose2>(3, 4, Pose2(2, 0, M_PI_2), model));\ngraph.add(BetweenFactor<Pose2>(4, 5, Pose2(2, 0, M_PI_2), model));\n\n// Add the loop closure constraint\ngraph.add(BetweenFactor<Pose2>(5, 2, Pose2(2, 0, M_PI_2), model));","key":"vaLcWuJ3p6"},{"type":"paragraph","position":{"start":{"line":379,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"As before, lines 1-4 create a nonlinear factor graph and add the unary factor ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"BydUSt9f6F"},{"type":"inlineMath","value":"f_0(x_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_0(x_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"wTeGJLNtWV"},{"type":"text","value":". As the robot travels through the world, it creates binary factors\n","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"sdrod1kNn9"},{"type":"inlineMath","value":"f_t(x_t, x_{t+1})","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_t(x_t, x_{t+1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"J2j7YIUQE3"},{"type":"text","value":" corresponding to odometry, added to the graph in lines 6-12 (Note that M_PI_2 refers to pi/2). But line 15 models a different event: a ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"zI6U7CxBmM"},{"type":"strong","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"loop closure","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"dPAIYMTYt7"}],"key":"kjKj4AumPO"},{"type":"text","value":". For example, the robot might recognize the same location using vision or a laser range finder, and calculate the geometric pose constraint to when it first visited this location. This is illustrated for poses ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"iYFdyAuFG7"},{"type":"inlineMath","value":"x_5","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>5</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"B44Ck8dGzV"},{"type":"text","value":" and ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"qEW5mOEXhK"},{"type":"inlineMath","value":"x_2","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tiHGH56K1P"},{"type":"text","value":", and generates the (red) loop closing factor ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"Uonkeoq3g0"},{"type":"inlineMath","value":"f_5(x_5, x_2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>5</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>5</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_5(x_5, x_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ujqjZRXM5j"},{"type":"text","value":".","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"eSs6lwtV7Y"}],"key":"dm8Xqu3oGR"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/7_example1-72ce1e9a09ab21d432871e0b88cf3f69.png","alt":"The result of running optimize on the factor graph in Figure 6.","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"HMoz1ygYW8","urlSource":"_static/Tutorial/7_example1.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 7","identifier":"figure 7","html_id":"figure-7","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"J9qYZPwv7r"},{"type":"text","value":"7","key":"lf3r5mEPhL"},{"type":"text","value":":","key":"Ag7d0SX98f"}],"template":"Figure %s:","key":"GK8vSwnJyf"},{"type":"text","value":"The result of running optimize on the factor graph in Figure 6.","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"hPbz2K6fqk"}],"key":"DiB0MhXRoO"}],"key":"GECox3tXxO"}],"label":"Figure 7","identifier":"figure 7","enumerator":"7","html_id":"figure-7","key":"N3xfUpIodz"},{"type":"paragraph","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"children":[{"type":"text","value":"We can optimize this factor graph as before, by creating an initial estimate of type Values, and creating and running an optimizer. The result is shown graphically in Figure 7, along with covariance ellipses shown in green. These 5-sigma covariance ellipses in 2D indicate the marginal over position, over all possible orientations, and show the area which contain 99.9996% of the probability mass. The graph shows in a clear manner that the uncertainty on pose ","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"AU2vWVcCvU"},{"type":"inlineMath","value":"x_5","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>5</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PmRm4zUVwt"},{"type":"text","value":" is now much less than if there would be only odometry measurements. The pose with the highest uncertainty, ","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"J3O86AXmmJ"},{"type":"inlineMath","value":"x_4","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>4</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ksuZ4V2dy8"},{"type":"text","value":", is the one furthest away from the unary constraint ","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"TKdyY09xLR"},{"type":"inlineMath","value":"f_0(x_1)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_0(x_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"WNMsy7vB3i"},{"type":"text","value":", which is the only factor tying the graph to a global coordinate frame.","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"r8dG63rcPs"}],"key":"J1JoQm63km"},{"type":"paragraph","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"children":[{"type":"text","value":"The figure above was created using an interface that allows you to use GTSAM from within MATLAB, which provides for visualization and rapid development. We discuss this next.","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"IiDdom8RYa"}],"key":"BPhtVTjjfN"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":394,"column":1}},"children":[{"type":"text","value":"4.2 Using the MATLAB Interface\nA large subset of the GTSAM functionality can be accessed through wrapped classes from within MATLAB","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"bneR6yxyaE"},{"type":"footnoteReference","identifier":"1","label":"1","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"enumerator":"1","key":"iOsGyRJQr1"},{"type":"text","value":". The following code excerpt is the MATLAB equivalent of the C++ code in Listing 4.1:","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"RcdjYdhMNP"}],"key":"AzVdvQPMpX"},{"type":"code","lang":"c","showLineNumbers":true,"value":"graph = NonlinearFactorGraph;\npriorNoise = noiseModel.Diagonal.Sigmas([0.3; 0.3; 0.1]);\ngraph.add(PriorFactorPose2(1, Pose2(0, 0, 0), priorNoise));\n\n%% Add odometry factors\nmodel = noiseModel.Diagonal.Sigmas([0.2; 0.2; 0.1]);\ngraph.add(BetweenFactorPose2(1, 2, Pose2(2, 0, 0   ), model));\ngraph.add(BetweenFactorPose2(2, 3, Pose2(2, 0, pi/2), model));\ngraph.add(BetweenFactorPose2(3, 4, Pose2(2, 0, pi/2), model));\ngraph.add(BetweenFactorPose2(4, 5, Pose2(2, 0, pi/2), model));\n\n%% Add pose constraint\ngraph.add(BetweenFactorPose2(5, 2, Pose2(2, 0, pi/2), model));","key":"RIGbeUhYxK"},{"type":"paragraph","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Note that the code is almost identical, although there are a few syntax and naming differences:","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"juPR6Kmb4P"}],"key":"IdC0vmyEc4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":417,"column":1},"end":{"line":421,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"text","value":"Objects are created by calling a constructor instead of allocating them on the heap.","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"key":"dOnTpA0EEF"}],"key":"W3Rza1pcjg"},{"type":"listItem","spread":true,"position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"children":[{"type":"text","value":"Namespaces are done using dot notation, i.e., ","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"J2w6uZerCn"},{"type":"inlineCode","value":"noiseModel::Diagonal::SigmasClasses","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"e24TpVbVQD"},{"type":"text","value":" becomes ","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"E9aOiOSQX1"},{"type":"inlineCode","value":"noiseModel.Diagonal.Sigmas","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"gHsHjBVGPL"},{"type":"text","value":".","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"AD8VNdYDTa"}],"key":"bwyrl1L2RO"},{"type":"listItem","spread":true,"position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"children":[{"type":"inlineCode","value":"Vector","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"Og93GyPdst"},{"type":"text","value":" and ","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"ASp0dShTSy"},{"type":"inlineCode","value":"Matrix","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"RCbKHKXCnh"},{"type":"text","value":" classes in C++ are just vectors/matrices in MATLAB.","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"SNgk9xYRmE"}],"key":"u3j6DXH331"},{"type":"listItem","spread":true,"position":{"start":{"line":420,"column":1},"end":{"line":421,"column":1}},"children":[{"type":"text","value":"As templated classes do not exist in MATLAB, these have been hardcoded in the GTSAM interface, e.g., ","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"nVT805s505"},{"type":"inlineCode","value":"PriorFactorPose2","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"tWrCJ5RYTI"},{"type":"text","value":" corresponds to the C++ class ","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"H7KhrMncUQ"},{"type":"inlineCode","value":"PriorFactor<Pose2>","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"lwBPsUiylm"},{"type":"text","value":", etc.","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"He7iqUUOzS"}],"key":"Z7s47C7ayq"}],"key":"qXxT6ng379"},{"type":"paragraph","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"After executing the code, you can call ","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"brafY5M0T1"},{"type":"inlineCode","value":"whos","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"sQDicVgE5l"},{"type":"text","value":" on the MATLAB command prompt to see the objects created. Note that the indicated Class corresponds to the wrapped C++ classes:","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"ivZp1shaSF"}],"key":"JUiWqAOt5n"},{"type":"code","lang":"","value":">> whos\nName                 Size            Bytes  Class\ngraph                1x1               112  gtsam.NonlinearFactorGraph\npriorNoise           1x1               112  gtsam.noiseModel.Diagonal\nmodel                1x1               112  gtsam.noiseModel.Diagonal\ninitialEstimate      1x1               112  gtsam.Values\noptimizer            1x1               112  gtsam.LevenbergMarquardtOptimizer","position":{"start":{"line":424,"column":1},"end":{"line":430,"column":1}},"key":"LvgYJCTEY4"},{"type":"paragraph","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"In addition, any GTSAM object can be examined in detail, yielding identical output to C++:","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"oAsbBR21op"}],"key":"KtXzGEfuFH"},{"type":"code","lang":"","value":">> priorNoise\ndiagonal sigmas [0.3; 0.3; 0.1];\n\n>> graph\nsize: 6\nfactor 0: PriorFactor on 1\nprior mean: (0, 0, 0)\nnoise model: diagonal sigmas [0.3; 0.3; 0.1];\nfactor 1: BetweenFactor(1,2)\nmeasured: (2, 0, 0)\nnoise model: diagonal sigmas [0.2; 0.2; 0.1];\nfactor 2: BetweenFactor(2,3)\nmeasured: (2, 0, 1.6)\nnoise model: diagonal sigmas [0.2; 0.2; 0.1];\nfactor 3: BetweenFactor(3,4)\nmeasured: (2, 0, 1.6)\nnoise model: diagonal sigmas [0.2; 0.2; 0.1];\nfactor 4: BetweenFactor(4,5)\nmeasured: (2, 0, 1.6)\nnoise model: diagonal sigmas [0.2; 0.2; 0.1];\nfactor 5: BetweenFactor(5,2)\nmeasured: (2, 0, 1.6)\nnoise model: diagonal sigmas [0.2; 0.2; 0.1];","position":{"start":{"line":434,"column":1},"end":{"line":456,"column":1}},"key":"Uo9js01Ns4"},{"type":"paragraph","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"children":[{"type":"text","value":"And it does not stop there: we can also call some of the functions defined for factor graphs. E.g.,","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"pDQn4I7Twf"}],"key":"bvdQ8Y6R5a"},{"type":"code","lang":"","value":">> graph.error(initialEstimate)\nans =\n20.1086\n\n>> graph.error(result)\nans =\n8.2631e-18","position":{"start":{"line":460,"column":1},"end":{"line":466,"column":1}},"key":"l0bmgEaDm0"},{"type":"paragraph","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"children":[{"type":"text","value":"computes the sum-squared error ","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"aDe5UvFvRp"},{"type":"inlineMath","value":"\\frac{1}{2} \\sum_i \\| h_i(X_i) - z_i \\|^2_{\\Sigma}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mo>∑</mo><mi>i</mi></msub><mi mathvariant=\"normal\">∥</mi><msub><mi>h</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>z</mi><mi>i</mi></msub><msubsup><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"normal\">Σ</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{2} \\sum_i \\| h_i(X_i) - z_i \\|^2_{\\Sigma}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∥</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4247em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">Σ</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YorErdTDg2"},{"type":"text","value":" before and after optimization.","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"GWwLWqxRY6"}],"key":"o4uAt2FqpO"},{"type":"heading","depth":3,"position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"children":[{"type":"text","value":"4.3 Reading and Optimizing Pose Graphs","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"FAcCvekJt6"}],"identifier":"id-4-3-reading-and-optimizing-pose-graphs","label":"4.3 Reading and Optimizing Pose Graphs","html_id":"id-4-3-reading-and-optimizing-pose-graphs","implicit":true,"key":"d1sPCocT22"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/8_w100-result-9faa614e1c1b7c594e93eba27de5f1ee.png","alt":"MATLAB plot of small Manhattan world example with 100 poses (due to Ed Olson). The initial estimate is shown in green. The optimized trajectory, with covariance ellipses, in blue.","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"II1fnlbJEV","urlSource":"_static/Tutorial/8_w100-result.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 8","identifier":"figure 8","html_id":"figure-8","enumerator":"8","children":[{"type":"text","value":"Figure ","key":"LYSbImhf9v"},{"type":"text","value":"8","key":"tHa1DaA60i"},{"type":"text","value":":","key":"o7FzomCmHv"}],"template":"Figure %s:","key":"IlPuA8Kn9U"},{"type":"text","value":"MATLAB plot of small Manhattan world example with 100 poses (due to Ed Olson). The initial estimate is shown in green. The optimized trajectory, with covariance ellipses, in blue.","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"Pj6HCtGsUt"}],"key":"jZMJHkUxgv"}],"key":"iH7hsflJ0u"}],"label":"Figure 8","identifier":"figure 8","enumerator":"8","html_id":"figure-8","key":"e3l1J67cJ8"},{"type":"paragraph","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"children":[{"type":"text","value":"The ability to work in MATLAB adds a much quicker development cycle, and effortless graphical output. The optimized trajectory in Figure 8 was produced by the code below, in which ","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"key":"Z0h4iD1yZX"},{"type":"inlineCode","value":"load2D()","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"key":"V4ZwyDGMMZ"},{"type":"text","value":" reads TORO files. To see how plotting is done, refer to the full source code.","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"key":"EkH3beayBK"}],"key":"J052JeGgNq"},{"type":"code","lang":"matlab","showLineNumbers":true,"value":"%% Initialize graph, initial estimate, and odometry noise\ndatafile = findExampleDataFile('w100.graph');\nmodel = noiseModel.Diagonal.Sigmas([0.05; 0.05; 5*pi/180]);\n[graph,initial] = load2D(datafile, model);\n\n%% Add a Gaussian prior on pose x_0\npriorMean = Pose2(0, 0, 0);\npriorNoise = noiseModel.Diagonal.Sigmas([0.01; 0.01; 0.01]);\ngraph.add(PriorFactorPose2(0, priorMean, priorNoise));\n\n%% Optimize using Levenberg-Marquardt optimization and get marginals\noptimizer = LevenbergMarquardtOptimizer(graph, initial);\nresult = optimizer.optimizeSafely;\nmarginals = Marginals(graph, result);","key":"e6NVXr1wJi"},{"type":"heading","depth":3,"position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"text","value":"4.4 PoseSLAM in 3D","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"cuCrvJJjJ1"}],"identifier":"id-4-4-poseslam-in-3d","label":"4.4 PoseSLAM in 3D","html_id":"id-4-4-poseslam-in-3d","implicit":true,"key":"xRREYGFo09"},{"type":"paragraph","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"children":[{"type":"text","value":"PoseSLAM can easily be extended to 3D poses, but some care is needed to update 3D rotations. GTSAM supports both ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"ndtATefUfx"},{"type":"strong","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"children":[{"type":"text","value":"quaternions","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"TaoHlZtpAl"}],"key":"qT1qOFBUkj"},{"type":"text","value":" and ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"pkSYqnmkW5"},{"type":"inlineMath","value":"3 \\times 3","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3 \\times 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"NzJ0VunC9f"},{"type":"text","value":" ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"q2jfah68EO"},{"type":"strong","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"children":[{"type":"text","value":"rotation matrices","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"mCfdiZOcmW"}],"key":"jG8NudL2hV"},{"type":"text","value":" to represent 3D rotations. The selection is made via the compile flag ","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"ZoxE6BBfR2"},{"type":"inlineCode","value":"GTSAM_USE_QUATERNIONS","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"Naa8OMaTKe"},{"type":"text","value":".","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"ydB9KpvNku"}],"key":"xWrR1BKL2Q"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/9_sphere2500-result-14990b7125b965e33e0bca9b0e636549.png","alt":"3D plot of sphere example (due to Michael Kaess). The very wrong initial estimate, derived from odometry, is shown in green. The optimized trajectory is shown red. Code below:","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"RdfPXSxv6q","urlSource":"_static/Tutorial/9_sphere2500-result.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 9","identifier":"figure 9","html_id":"figure-9","enumerator":"9","children":[{"type":"text","value":"Figure ","key":"PZ714gZCFx"},{"type":"text","value":"9","key":"htwCt10m2g"},{"type":"text","value":":","key":"HgtHhbpYkJ"}],"template":"Figure %s:","key":"yaYVa4cHve"},{"type":"text","value":"3D plot of sphere example (due to Michael Kaess). The very wrong initial estimate, derived from odometry, is shown in green. The optimized trajectory is shown red. Code below:","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"MV6F8A7avm"}],"key":"STwk2OAEWC"}],"key":"AudeLv9MdF"}],"label":"Figure 9","identifier":"figure 9","enumerator":"9","html_id":"figure-9","key":"oYOsDi5kdP"},{"type":"code","lang":"matlab","showLineNumbers":true,"value":"%% Initialize graph, initial estimate, and odometry noise\ndatafile = findExampleDataFile('sphere2500.txt');\nmodel = noiseModel.Diagonal.Sigmas([5*pi/180; 5*pi/180; 5*pi/180; 0.05; 0.05; 0.05]);\n[graph,initial] = load3D(datafile, model, true, 2500);\nplot3DTrajectory(initial, 'g-', false); % Plot Initial Estimate\n\n%% Read again, now with all constraints, and optimize\ngraph = load3D(datafile, model, false, 2500);\ngraph.add(NonlinearEqualityPose3(0, initial.atPose3(0)));\noptimizer = LevenbergMarquardtOptimizer(graph, initial);\nresult = optimizer.optimizeSafely();\nplot3DTrajectory(result, 'r-', false); axis equal;","key":"rY29QOt0Kd"},{"type":"heading","depth":2,"position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"5. Landmark-based SLAM","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"WbftUDDXPK"}],"identifier":"id-5-landmark-based-slam","label":"5. Landmark-based SLAM","html_id":"id-5-landmark-based-slam","implicit":true,"key":"Y0FfoEx1ia"},{"type":"heading","depth":3,"position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"text","value":"5.1 Basics","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"sFqkmUvnBa"}],"identifier":"id-5-1-basics","label":"5.1 Basics","html_id":"id-5-1-basics","implicit":true,"key":"w8lCyaC9PQ"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/10_FactorGraph4-c1f64b2db58d94b7338c04ed41c910f7.png","alt":"Factor graph for landmark-based SLAM","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"hfyGqA6saB","urlSource":"_static/Tutorial/10_FactorGraph4.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 10","identifier":"figure 10","html_id":"figure-10","enumerator":"10","children":[{"type":"text","value":"Figure ","key":"AkKEcq44pK"},{"type":"text","value":"10","key":"mxL9xDbfXn"},{"type":"text","value":":","key":"EyoLf4eHwQ"}],"template":"Figure %s:","key":"tPVzemKNkB"},{"type":"text","value":"Factor graph for landmark-based SLAM","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"rnVz1mfRXc"}],"key":"RMzOXpB20x"}],"key":"BZCZYOQTGQ"}],"label":"Figure 10","identifier":"figure 10","enumerator":"10","html_id":"figure-10","key":"GbXmNl5HT5"},{"type":"paragraph","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"FR36rkx6V2"},{"type":"strong","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"children":[{"type":"text","value":"landmark-based SLAM","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"SXeaX6wZTm"}],"key":"CZFlDeyggJ"},{"type":"text","value":", we explicitly build a map with the location of observed landmarks, which introduces a second type of variable in the factor graph besides robot poses. An example factor graph for a landmark-based SLAM example is shown in Figure 10, which shows the typical connectivity: poses are connected in an odometry Markov chain, and landmarks are observed from multiple poses, inducing binary factors. In addition, the pose ","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"yRRO0DhXRQ"},{"type":"inlineMath","value":"x_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rgcMPSEBbd"},{"type":"text","value":" has the usual prior on it.","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"z4704T5Scy"}],"key":"wVaKXX4DPd"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/11_example2-34b6fd54af743fb8f0114e795846f204.png","alt":"The optimized result along with covariance ellipses for both poses (in green) and landmarks (in blue). Also shown are the trajectory (red) and landmark sightings (cyan).","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"s1JAxy2rSF","urlSource":"_static/Tutorial/11_example2.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 11","identifier":"figure 11","html_id":"figure-11","enumerator":"11","children":[{"type":"text","value":"Figure ","key":"CcjRi4LMWc"},{"type":"text","value":"11","key":"GRfef5fpkH"},{"type":"text","value":":","key":"EkQXfnCX7G"}],"template":"Figure %s:","key":"nyA5ThQ7wW"},{"type":"text","value":"The optimized result along with covariance ellipses for both poses (in green) and landmarks (in blue). Also shown are the trajectory (red) and landmark sightings (cyan).","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"Sm57egUhFn"}],"key":"Kol31nhydY"}],"key":"Hlg8V3rctH"}],"label":"Figure 11","identifier":"figure 11","enumerator":"11","html_id":"figure-11","key":"lioaTeOqPq"},{"type":"paragraph","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"text","value":"The factor graph from Figure 10 can be created using the MATLAB code in Listing 5.1. As before, on line 2 we create the factor graph, and Lines 8-18 create the prior/odometry chain we are now familiar with. However, the code on lines 20-25 is new: it creates three ","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"ucrUqSIKzW"},{"type":"strong","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"text","value":"measurement factors","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"cDgq15dZKx"}],"key":"HpR1RcIkwq"},{"type":"text","value":", in this case “bearing/range” measurements from the pose to the landmark.","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"ptdfUKbRyG"}],"key":"W3eIgZLwFV"},{"type":"code","lang":"matlab","showLineNumbers":true,"value":"% Create graph container and add factors to it\ngraph = NonlinearFactorGraph;\n\n% Create keys for variables\ni1 = symbol('x',1); i2 = symbol('x',2); i3 = symbol('x',3);\nj1 = symbol('l',1); j2 = symbol('l',2);\n\n% Add prior\npriorMean = Pose2(0.0, 0.0, 0.0); % prior at origin\npriorNoise = noiseModel.Diagonal.Sigmas([0.3; 0.3; 0.1]);\n% add directly to graph\ngraph.add(PriorFactorPose2(i1, priorMean, priorNoise));\n\n% Add odometry\nodometry = Pose2(2.0, 0.0, 0.0);\nodometryNoise = noiseModel.Diagonal.Sigmas([0.2; 0.2; 0.1]);\ngraph.add(BetweenFactorPose2(i1, i2, odometry, odometryNoise));\ngraph.add(BetweenFactorPose2(i2, i3, odometry, odometryNoise));\n\n% Add bearing/range measurement factors\ndegrees = pi/180;\nbrNoise = noiseModel.Diagonal.Sigmas([0.1; 0.2]);\ngraph.add(BearingRangeFactor2D(i1, j1, Rot2(45*degrees), sqrt(8), brNoise));\ngraph.add(BearingRangeFactor2D(i2, j1, Rot2(90*degrees), 2, brNoise));\ngraph.add(BearingRangeFactor2D(i3, j2, Rot2(90*degrees), 2, brNoise));","key":"WK0vzh632Z"},{"type":"heading","depth":3,"position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"text","value":"5.2 Of Keys and Symbols","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"iIIy7TlzZx"}],"identifier":"id-5-2-of-keys-and-symbols","label":"5.2 Of Keys and Symbols","html_id":"id-5-2-of-keys-and-symbols","implicit":true,"key":"WPLVIWF9us"},{"type":"paragraph","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"The only unexplained code is on lines 4-6: here we create integer keys for the poses and landmarks using the ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"jK7IEaJimD"},{"type":"inlineCode","value":"symbol()","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"AViXR0EEnV"},{"type":"text","value":" function. In GTSAM, we address all variables using the ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"tvZLhQgNH1"},{"type":"inlineCode","value":"Key","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"jUKHMB6sUB"},{"type":"text","value":" type, which is just a typedef to ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"JuqM6XYb7i"},{"type":"inlineCode","value":"size_t","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"pb0LcGdmoL"},{"type":"text","value":" ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"Xl8gQUTmQi"},{"type":"footnoteReference","identifier":"2","label":"2","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"enumerator":"2","key":"XmRiez9mrg"},{"type":"text","value":" . The keys do not have to be numbered continuously, but they do have to be unique within a given factor graph. For factor graphs with different types of variables, we provide the ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"awBoiFgSoA"},{"type":"inlineCode","value":"symbol()","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"gPo1EOlDhA"},{"type":"text","value":" function in MATLAB, and the ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"GMom2tLY94"},{"type":"inlineCode","value":"Symbol","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"NP6Tseo5GB"},{"type":"text","value":" type in C++, to help you create (large) integer keys that are far apart in the space of possible keys, so you don’t have to think about starting the point numbering at some arbitrary offset. To create a ","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"kvtM9sjUE2"},{"type":"emphasis","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"symbol","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"E0YSTMJxlk"}],"key":"iLlroOSDyV"},{"type":"text","value":" key you simply provide a character and an integer index. You can use base 0 or 1, or use arbitrary indices: it does not matter. In the code above, we we use ‘x’ for poses, and ‘l’ for landmarks.","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"OOw4uytY14"}],"key":"yumygP1Air"},{"type":"paragraph","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"children":[{"type":"text","value":"The optimized result for the factor graph created by Listing 5.1 is shown in Figure 11, and it is readily apparent that the landmark ","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"xP3y8vSLyw"},{"type":"inlineMath","value":"l_1","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">l_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DyLxusCjTP"},{"type":"text","value":" with two measurements is better localized. In MATLAB we can also examine the actual numerical values, and doing so reveals some more GTSAM magic:","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"rKwMNisF8P"}],"key":"pguZLo4K8n"},{"type":"code","lang":"","value":"result Values with 5 values: l1: (2, 2) l2: (4, 2) x1: (-1.8e-16, 5.1e-17, -1.5e-17) x2: (2, -5.8e-16, -4.6e-16) x3: (4, -3.1e-15, -4.6e-16)","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"CrNmYj9VCQ"},{"type":"paragraph","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"text","value":"Indeed, the keys generated by symbol are automatically detected by the ","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"GNA5KxRtcA"},{"type":"inlineCode","value":"print","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"OC9xLlCLbj"},{"type":"text","value":" method in the ","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"WI1XDFVrPx"},{"type":"inlineCode","value":"Values","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"sq6wG5ipIm"},{"type":"text","value":" class, and rendered in human-readable form “x1”, “l2”, etc, rather than as large, unwieldy integers. This magic extends to most factors and other classes where the ","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"nwSmy2GSHG"},{"type":"inlineCode","value":"Key","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"HbjVjdUvgi"},{"type":"text","value":" type is used.","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"PpFYwtuv3E"}],"key":"z5WHb1ppRJ"},{"type":"heading","depth":3,"position":{"start":{"line":589,"column":1},"end":{"line":589,"column":1}},"children":[{"type":"text","value":"5.3 A Larger Example","position":{"start":{"line":589,"column":1},"end":{"line":589,"column":1}},"key":"xT6zjIDycW"}],"identifier":"id-5-3-a-larger-example","label":"5.3 A Larger Example","html_id":"id-5-3-a-larger-example","implicit":true,"key":"zPTqs9ZRF2"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/12_littleRobot-e05a22d0a5a9badaac0e5267b5de4afb.png","alt":"A larger example with about 100 poses and 30 or so landmarks, as produced by gtsam_examples/PlanarSLAMExample_graph.m","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"hWuDVOVRzx","urlSource":"_static/Tutorial/12_littleRobot.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 12","identifier":"figure 12","html_id":"figure-12","enumerator":"12","children":[{"type":"text","value":"Figure ","key":"JJnXsA3a5n"},{"type":"text","value":"12","key":"cIxJ1QVcRi"},{"type":"text","value":":","key":"aMECjHDYco"}],"template":"Figure %s:","key":"jLgdfempJO"},{"type":"text","value":"A larger example with about 100 poses and 30 or so landmarks, as produced by ","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"mDM8MRBfRA"},{"type":"inlineCode","value":"gtsam_examples/PlanarSLAMExample_graph.m","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"R0kjDVxELp"}],"key":"E6UjBBUDVu"}],"key":"RMwJEj5psx"}],"label":"Figure 12","identifier":"figure 12","enumerator":"12","html_id":"figure-12","key":"ZTwthY0TE2"},{"type":"paragraph","position":{"start":{"line":598,"column":1},"end":{"line":598,"column":1}},"children":[{"type":"text","value":"GTSAM comes with a slightly larger example that is read from a ","position":{"start":{"line":598,"column":1},"end":{"line":598,"column":1}},"key":"C8AbNo3ibL"},{"type":"inlineCode","value":".graph","position":{"start":{"line":598,"column":1},"end":{"line":598,"column":1}},"key":"tG4ET6r7p1"},{"type":"text","value":" file by ","position":{"start":{"line":598,"column":1},"end":{"line":598,"column":1}},"key":"KpbkbAnYpf"},{"type":"inlineCode","value":"PlanarSLAMExample_graph.m","position":{"start":{"line":598,"column":1},"end":{"line":598,"column":1}},"key":"lDivxCPvGB"},{"type":"text","value":", shown in Figure 12. To not clutter the figure only the marginals are shown, not the lines of sight. This example, with 119 (multivariate) variables and 517 factors optimizes in less than 10 ms.","position":{"start":{"line":598,"column":1},"end":{"line":598,"column":1}},"key":"mDqvedfns1"}],"key":"v7K6WgcjHi"},{"type":"heading","depth":3,"position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"children":[{"type":"text","value":"5.4 A Real-World Example","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"ScEXY8K09x"}],"identifier":"id-5-4-a-real-world-example","label":"5.4 A Real-World Example","html_id":"id-5-4-a-real-world-example","implicit":true,"key":"Zxb9vUEWZG"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/13_Victoria-6a60f77640433c63693c430b577fccad.png","alt":"Small section of optimized trajectory and landmarks (trees detected in a laser range finder scan) from data recorded in Sydney’s Victoria Park (dataset due to Jose Guivant, U. Sydney).","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"njPWezwK0H","urlSource":"_static/Tutorial/13_Victoria.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":606,"column":1},"end":{"line":606,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 13","identifier":"figure 13","html_id":"figure-13","enumerator":"13","children":[{"type":"text","value":"Figure ","key":"ggGtEI7ZsO"},{"type":"text","value":"13","key":"BuGfem9m4P"},{"type":"text","value":":","key":"LBHWar4hix"}],"template":"Figure %s:","key":"VStjWbsWeH"},{"type":"text","value":"Small section of optimized trajectory and landmarks (trees detected in a laser range finder scan) from data recorded in Sydney’s Victoria Park (dataset due to Jose Guivant, U. Sydney).","position":{"start":{"line":606,"column":1},"end":{"line":606,"column":1}},"key":"oJneaTRsMr"}],"key":"bzyjCGK775"}],"key":"hQMuQReTei"}],"label":"Figure 13","identifier":"figure 13","enumerator":"13","html_id":"figure-13","key":"VYETvsGwDm"},{"type":"paragraph","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"children":[{"type":"text","value":"A real-world example is shown in Figure 13, using data from a well known dataset collected in Sydney’s Victoria Park, using a truck equipped with a laser range-finder. The covariance matrices in this figure were computed very efficiently, as explained in detail in ","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"KSwco8eGDm"},{"type":"cite","kind":"narrative","label":"KaessDellaert2009","identifier":"kaessdellaert2009","children":[{"type":"text","value":"Kaess & Dellaert (2009)","key":"m8og3L5fAm"}],"enumerator":"4","key":"PNTQMW3qA7"},{"type":"text","value":". The exact covariances (blue, smaller ellipses) obtained by our fast algorithm coincide with the exact covariances based on full inversion (orange, mostly hidden by blue). The much larger conservative covariance estimates (green, large ellipses) were based on our earlier work in ","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"PVt95MBuBv"},{"type":"cite","kind":"narrative","label":"Kaess2008","identifier":"kaess2008","children":[{"type":"text","value":"Kaess & Dellaert (2008)","key":"deOwATGq8C"}],"enumerator":"6","key":"rcDnLFKsD5"},{"type":"text","value":".","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"Cx16pOjSSx"}],"key":"JYrPAwAst5"},{"type":"heading","depth":2,"position":{"start":{"line":611,"column":1},"end":{"line":611,"column":1}},"children":[{"type":"text","value":"6. Structure from Motion","position":{"start":{"line":611,"column":1},"end":{"line":611,"column":1}},"key":"IHVWpTmUUR"}],"identifier":"id-6-structure-from-motion","label":"6. Structure from Motion","html_id":"id-6-structure-from-motion","implicit":true,"key":"YH0ODA7rBl"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/14_cube-4cbbcf930f846aea7ea289efd674c252.png","alt":"An optimized “Structure from Motion” with 10 cameras arranged in a circle, observing the 8 vertices of a 20 \\times 20 \\times 20 cube centered around the origin. The camera is rendered with color-coded axes, (RGB for XYZ) and the viewing direction is is along the positive Z-axis. Also shown are the 3D error covariance ellipses for both cameras and points.","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"LhD6U5RQPh","urlSource":"_static/Tutorial/14_cube.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 14","identifier":"figure 14","html_id":"figure-14","enumerator":"14","children":[{"type":"text","value":"Figure ","key":"tHKBRKv07d"},{"type":"text","value":"14","key":"gZ8CJML5Kn"},{"type":"text","value":":","key":"qfToiJYsgh"}],"template":"Figure %s:","key":"UX6Iwi4aN4"},{"type":"text","value":"An optimized “Structure from Motion” with 10 cameras arranged in a circle, observing the 8 vertices of a ","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"tGpoyAjrsb"},{"type":"inlineMath","value":"20 \\times 20 \\times 20","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>20</mn><mo>×</mo><mn>20</mn><mo>×</mo><mn>20</mn></mrow><annotation encoding=\"application/x-tex\">20 \\times 20 \\times 20</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">20</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">20</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">20</span></span></span></span>","key":"Cj74qMEXg4"},{"type":"text","value":" cube centered around the origin. The camera is rendered with color-coded axes, (RGB for XYZ) and the viewing direction is is along the positive Z-axis. Also shown are the 3D error covariance ellipses for both cameras and points.","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"T7X7iAdrtW"}],"key":"FxDMiqKkbk"}],"key":"eF9xIJ8CFH"}],"label":"Figure 14","identifier":"figure 14","enumerator":"14","html_id":"figure-14","key":"R9UhKUEdMA"},{"type":"paragraph","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"strong","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"Structure from Motion (SFM)","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"dkqLQXVVNa"}],"key":"rbLrLTWBEN"},{"type":"text","value":" is a technique to recover a 3D reconstruction of the environment from corresponding visual features in a collection of unordered images, see Figure 14. In GTSAM this is done using exactly the same factor graph framework, simply using SFM-specific measurement factors. In particular, there is a ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"JeRXARhjV6"},{"type":"strong","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"projection factor","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"ELgzX3Zahw"}],"key":"GVzWIqO1iR"},{"type":"text","value":" that calculates the reprojection error ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"mFNsvekPle"},{"type":"inlineMath","value":"f(x_i, p_j, z_{ij}, K)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>p</mi><mi>j</mi></msub><mo separator=\"true\">,</mo><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator=\"true\">,</mo><mi>K</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x_i, p_j, z_{ij}, K)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mclose\">)</span></span></span></span>","key":"GlbypnrLtY"},{"type":"text","value":" for a given camera pose ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"TpXqSERaG6"},{"type":"inlineMath","value":"x_i","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WShqZh7Fec"},{"type":"text","value":" (a ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"d54oMvn9RY"},{"type":"strong","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"Pose3","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"p42RvFwVaE"}],"key":"cOC7T9x3mo"},{"type":"text","value":") and a point ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"k7LLDnw0nx"},{"type":"inlineMath","value":"p_j","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FJFXpCBhTm"},{"type":"text","value":" ( a ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"vyzvxqL7Ty"},{"type":"strong","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"Point3","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"imRZ3lD7JN"}],"key":"e1Bt8S3ZS3"},{"type":"text","value":"). The factor is parameterized by the 2D measurement ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"gozLnJlHBq"},{"type":"inlineMath","value":"z_{ij}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">z_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gOXfTBoQRF"},{"type":"text","value":" (a ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"NlDR8S8ReO"},{"type":"strong","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"Point 2","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"sfEAEoH5Ee"}],"key":"ExCWhHomr6"},{"type":"text","value":"), and known calibration parameters ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"hlagvbfJKi"},{"type":"inlineMath","value":"K","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"y5E3kjOXCd"},{"type":"text","value":" (of type ","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"miVmnSfdgQ"},{"type":"strong","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"text","value":"Cal3_S2","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"PEiKrWKAoL"}],"key":"EVfqNcMAwp"},{"type":"text","value":"). The following listing shows how to create the factor graph:","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"key":"LlgJIU6wVi"}],"key":"wnbWDstuK7"},{"type":"code","lang":"matlab","showLineNumbers":true,"value":"%% Add factors for all measurements\nnoise = noiseModel.Isotropic.Sigma(2, measurementNoiseSigma);\nfor i = 1:length(Z),\n    for k = 1:length(Z{i})\n        j = J{i}{k};\n        G.add(GenericProjectionFactorCal3_S2(\n              Z{i}{k}, noise, symbol('x', i), symbol('p', j), K));\n    end\nend","key":"K9HtxvAGZm"},{"type":"paragraph","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"children":[{"type":"text","value":"In Listing 6, assuming that the factor graph was already created, we add measurement factors in the double loop. We loop over images with index ","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"WKHlUzdryx"},{"type":"inlineMath","value":"i","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"nQIpZ7Qvq1"},{"type":"text","value":", and in this example the data is given as two cell arrays: ","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"tGJVfANtP4"},{"type":"inlineCode","value":"Z{i}","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"CRT08qAgJ9"},{"type":"text","value":" specifies a set of measurements ","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"WHzxR1QtOs"},{"type":"inlineMath","value":"z_k","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">z_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gws6injr0I"},{"type":"text","value":" in image ","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"MFpBTTFgOG"},{"type":"inlineMath","value":"i","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"FLekvHa7h5"},{"type":"text","value":", and ","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"xiUbWVQnnL"},{"type":"inlineCode","value":"J{i}","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"DoWVjZ66mJ"},{"type":"text","value":" specifies the corresponding point index. The specific factor type we use is a ","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"n6Nr7Wu4oy"},{"type":"inlineCode","value":"GenericProjectionFactorCal3_S2","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"GAgND6aQSh"},{"type":"text","value":", which is the MATLAB equivalent of the C++ class ","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"xaMtbyr7eO"},{"type":"inlineCode","value":"GenericProjectionFactor<Cal3_S2>","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"uIVZsbpEbM"},{"type":"text","value":", where ","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"pXy0Ot587f"},{"type":"inlineCode","value":"Cal3_S2","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"ii0pVIzbuA"},{"type":"text","value":" is the camera calibration type we choose to use (the standard, no-radial distortion, 5 parameter calibration matrix). As before landmark-based SLAM (Section 5), here we use symbol keys except we now use the character ‘p’ to denote points, rather than ‘l’ for landmark.","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"aHxQHTRaPO"}],"key":"Ify0iblj72"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important","key":"uMk1aALd3Y"}],"key":"NfznBarrFn"},{"type":"paragraph","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"children":[{"type":"text","value":"A very tricky and difficult part of making SFM work is (a) ","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"key":"QdEU6DJSTW"},{"type":"strong","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"children":[{"type":"text","value":"data association","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"key":"ZV6YXRrqiG"}],"key":"LIzZhXdzOJ"},{"type":"text","value":", and (b) ","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"key":"ckfilEtjjE"},{"type":"strong","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"children":[{"type":"text","value":"initialization","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"key":"u33Ohg7itm"}],"key":"sqCkgipFMa"},{"type":"text","value":". GTSAM does neither of these things for you: it simply provides the “bundle adjustment” optimization. In the example, we simply assume the data association is known (it is encoded in the J sets), and we initialize with the ground truth, as the intent of the example is simply to show you how to set up the optimization problem.","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"key":"yKae3cHaXI"}],"key":"VJr9nA2AFH"}],"key":"KVM658zJUZ"},{"type":"heading","depth":2,"position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"children":[{"type":"text","value":"7. iSAM: Incremental Smoothing and Mapping","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"h07G5njed7"}],"identifier":"id-7-isam-incremental-smoothing-and-mapping","label":"7. iSAM: Incremental Smoothing and Mapping","html_id":"id-7-isam-incremental-smoothing-and-mapping","implicit":true,"key":"KNcsmVbzy0"},{"type":"paragraph","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"children":[{"type":"text","value":"GTSAM provides an incremental inference algorithm based on a more advanced graphical model, the Bayes tree, which is kept up to date by the ","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"HXdOBIs6mL"},{"type":"strong","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"children":[{"type":"text","value":"iSAM","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"HJ41tmyUbD"}],"key":"NMeVhXAyPM"},{"type":"text","value":" algorithm (incremental Smoothing and Mapping, see ","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"Wqs94TnBNA"},{"type":"cite","kind":"narrative","label":"Kaess2008","identifier":"kaess2008","children":[{"type":"text","value":"Kaess & Dellaert (2008)","key":"lZeEvbHjeT"}],"enumerator":"6","key":"B0czciiywG"},{"type":"text","value":"; ","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"fSnIvdWJNp"},{"type":"cite","kind":"narrative","label":"Kaess2012","identifier":"kaess2012","children":[{"type":"text","value":"Kaess & Dellaert (2012)","key":"nVWfcE7eRq"}],"enumerator":"7","key":"gCVz3nDegp"},{"type":"text","value":" for an in-depth treatment). For mobile robots operating in real-time it is important to have access to an updated map as soon as new sensor measurements come in. iSAM keeps the map up-to-date in an efficient manner.","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"JDz5aucwBq"}],"key":"lbxpALSxqZ"},{"type":"paragraph","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"children":[{"type":"text","value":"Listing 7 shows how to use iSAM in a simple visual SLAM example. In line 1-2 we create a NonlinearISAM object which will relinearize and reorder the variables every 3 steps. The corect value for this parameter depends on how non-linear your problem is and how close you want to be to gold-standard solution at every step. In iSAM 2.0, this parameter is not needed, as iSAM2 automatically determines when linearization is needed and for which variables.","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"key":"bCt1AmU0Mg"}],"key":"ELKTW2SO8M"},{"type":"paragraph","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"children":[{"type":"text","value":"The example involves eight 3D points that are seen from eight successive camera poses. Hence in the first step -which is omitted here- all eight landmarks and the first pose are properly initialized. In the code this is done by perturbing the known ground truth, but in a real application great care is needed to properly initialize poses and landmarks, especially in a monocular sequence.","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"fRxTnObzwt"}],"key":"ooTjBaN2cM"},{"type":"code","lang":"c","showLineNumbers":true,"value":"int relinearizeInterval = 3;\nNonlinearISAM isam(relinearizeInterval);\n\n// ... first frame initialization omitted ...\n\n// Loop over the different poses, adding the observations to iSAM\nfor (size_t i = 1; i < poses.size(); ++i) {\n\n  // Add factors for each landmark observation\n  NonlinearFactorGraph graph;\n  for (size_t j = 0; j < points.size(); ++j) {\n    graph.add(\n      GenericProjectionFactor<Pose3, Point3, Cal3_S2>\n        (z[i][j], noise,Symbol('x', i), Symbol('l', j), K)\n    );\n  }\n\n  // Add an initial guess for the current pose\n  Values initialEstimate;\n  initialEstimate.insert(Symbol('x', i), initial_x[i]);\n\n  // Update iSAM with the new factors\n  isam.update(graph, initialEstimate);\n }","key":"sHvruagQRw"},{"type":"paragraph","position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"children":[{"type":"text","value":"The remainder of the code illustrates a typical iSAM loop:","position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"key":"QrR9K3qlXY"}],"key":"VPAEQBBr7O"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":679,"column":1},"end":{"line":684,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":679,"column":1},"end":{"line":680,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"children":[{"type":"text","value":"Create factors for new measurements. Here, in lines 9-18, a small ","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"MUlhiSmbIi"},{"type":"inlineCode","value":"NonlinearFactorGraph","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"elCsuHQOvl"},{"type":"text","value":" is created to hold the new factors of type ","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"ldVO3GVbO7"},{"type":"inlineCode","value":"GenericProjectionFactor<Pose3, Point3, Cal3_S2>","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"en9KGp7HYz"},{"type":"text","value":".","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"wEnvU9BExQ"}],"key":"Q5TkKNIlNF"}],"key":"Ye9FltktvP"},{"type":"listItem","spread":true,"position":{"start":{"line":681,"column":1},"end":{"line":682,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"Create an initial estimate for all newly introduced variables. In this small example, all landmarks have been observed in frame 1 and hence the only new variable that needs to be initialized at each time step is the new pose. This is done in lines 20-22. Note we assume a good initial estimate is available as ","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"PI3RyjLpWE"},{"type":"inlineCode","value":"initial_x[i]","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"q5MLFAmO6U"},{"type":"text","value":".","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"pRoUa5iRyb"}],"key":"ra36igFxLW"}],"key":"X72egVvKwc"},{"type":"listItem","spread":true,"position":{"start":{"line":683,"column":1},"end":{"line":684,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"children":[{"type":"text","value":"Finally, we call ","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"NNhSqdBmpm"},{"type":"inlineCode","value":"isam.update()","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"U9iynX1RUR"},{"type":"text","value":", which takes the factors and initial estimates, and incrementally updates the solution, which is available through the method ","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"ZZxJf8U7WU"},{"type":"inlineCode","value":"isam.estimate()","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"e3xkACS8JT"},{"type":"text","value":", if desired.","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"XjuANW8uHt"}],"key":"AaP6rrqotn"}],"key":"y1hk0CfJhr"}],"key":"syHLRfBy3N"},{"type":"heading","depth":2,"position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"children":[{"type":"text","value":"8. More Applications","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"key":"nr2IEACvJq"}],"identifier":"id-8-more-applications","label":"8. More Applications","html_id":"id-8-more-applications","implicit":true,"key":"LngSSuNVwh"},{"type":"paragraph","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"children":[{"type":"text","value":"While a detailed discussion of all the things you can do with GTSAM will take us too far, below is a small survey of what you can expect to do, and which we did using GTSAM.","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"key":"KejjLV1FX8"}],"key":"mVmeStxM6d"},{"type":"heading","depth":3,"position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"children":[{"type":"text","value":"8.1 Conjugate Gradient Optimization","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"key":"YWklzV6EMI"}],"identifier":"id-8-1-conjugate-gradient-optimization","label":"8.1 Conjugate Gradient Optimization","html_id":"id-8-1-conjugate-gradient-optimization","implicit":true,"key":"eWLz4WdKlN"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/15_Beijing-90bd2b91682e59295b6a886de91ade84.png","alt":"A map of Beijing, with a spanning tree shown in black, and the remaining loop-closing constraints shown in red. A spanning tree can be used as a preconditioner by GTSAM.","width":"75%","data":{"altTextIsAutoGenerated":true},"key":"CJKYsTq3KV","urlSource":"_static/Tutorial/15_Beijing.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"Figure 15","identifier":"figure 15","html_id":"figure-15","enumerator":"15","children":[{"type":"text","value":"Figure ","key":"pMsdYva7PJ"},{"type":"text","value":"15","key":"pVs21spd7G"},{"type":"text","value":":","key":"Ll2fRxlgS6"}],"template":"Figure %s:","key":"dwDQTozaei"},{"type":"text","value":"A map of Beijing, with a spanning tree shown in black, and the remaining loop-closing constraints shown in red. A spanning tree can be used as a ","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"key":"ci7M9SsEvo"},{"type":"inlineCode","value":"preconditioner","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"key":"gK6NGgf8D1"},{"type":"text","value":" by GTSAM.","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"key":"HzRgk2Dihw"}],"key":"G6gn4cveaS"}],"key":"L314AoHkTx"}],"label":"Figure 15","identifier":"figure 15","enumerator":"15","html_id":"figure-15","key":"EaU5NAeHN8"},{"type":"paragraph","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"text","value":"GTSAM also includes efficient preconditioned conjugate gradients (PCG) methods for solving large-scale SLAM problems. While direct methods, popular in the literature, exhibit quadratic convergence and can be quite efficient for sparse problems, they typically require a lot of storage and efficient elimination orderings to be found. In contrast, iterative optimization methods only require access to the gradient and have a small memory footprint, but can suffer from poor convergence. Our method, ","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"Rr4V3RVi8Z"},{"type":"emphasis","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"text","value":"subgraph preconditioning","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"X99TM2QEtl"}],"key":"c32JwQy7Tb"},{"type":"text","value":", explained in detail in ","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"Fn00Q6gpz6"},{"type":"cite","kind":"narrative","label":"Dellaert2010","identifier":"dellaert2010","children":[{"type":"text","value":"Dellaert & Thorpe (2010)","key":"t9QjYBjohQ"}],"enumerator":"8","key":"YTVHxaSNgV"},{"type":"text","value":"; ","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"MoBAymlZJy"},{"type":"cite","kind":"narrative","label":"Jian2011","identifier":"jian2011","children":[{"type":"text","value":"Jian & Dellaert (2011)","key":"SmMpaI81TA"}],"enumerator":"9","key":"WFudEuAn3o"},{"type":"text","value":", combines the advantages of direct and iterative methods, by identifying a sub-problem that can be easily solved using direct methods, and solving for the remaining part using PCG. The easy sub-problems correspond to a spanning tree, a planar subgraph, or any other substructure that can be efficiently solved. An example of such a subgraph is shown in Figure 15.","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"xTqTUafqkP"}],"key":"LELevnbB25"},{"type":"heading","depth":3,"position":{"start":{"line":700,"column":1},"end":{"line":700,"column":1}},"children":[{"type":"text","value":"8.2 Visual Odometry","position":{"start":{"line":700,"column":1},"end":{"line":700,"column":1}},"key":"qPbiiaCnya"}],"identifier":"id-8-2-visual-odometry","label":"8.2 Visual Odometry","html_id":"id-8-2-visual-odometry","implicit":true,"key":"FVdWbQQY6b"},{"type":"paragraph","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"children":[{"type":"text","value":"A gentle introduction to vision-based sensing is Visual Odometry (abbreviated VO, see e.g. ","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"bTZ4AFrO1o"},{"type":"cite","kind":"narrative","label":"Nister2004","identifier":"nister2004","children":[{"type":"text","value":"Nistér & Bergen (2004)","key":"yWjAu1QCnp"}],"enumerator":"10","key":"qW1KVa7rpy"},{"type":"text","value":"), which provides pose constraints between successive robot poses by tracking or associating visual features in successive images taken by a camera mounted rigidly on the robot. GTSAM includes both C++ and MATLAB example code, as well as VO-specific factors to help you on the way.","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"jZTlt1Kth4"}],"key":"Bs1SVvEibd"},{"type":"heading","depth":3,"position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"text","value":"8.3 Visual SLAM","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"sXJ320fwiC"}],"identifier":"id-8-3-visual-slam","label":"8.3 Visual SLAM","html_id":"id-8-3-visual-slam","implicit":true,"key":"cOfs6UL2hK"},{"type":"paragraph","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"children":[{"type":"text","value":"Visual SLAM (see e.g., ","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"key":"ENxbO6QZV2"},{"type":"cite","kind":"narrative","label":"Davison2003","identifier":"davison2003","children":[{"type":"text","value":"Davison (2003)","key":"RQNFmI6OHR"}],"enumerator":"11","key":"Aeb1TGYUeK"},{"type":"text","value":") is a SLAM variant where 3D points are observed by a camera as the camera moves through space, either mounted on a robot or moved around by hand. GTSAM, and particularly iSAM (see below), can easily be adapted to be used as the back-end optimizer in such a scenario.","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"key":"JRSJR8g0x5"}],"key":"RhtSds3QXV"},{"type":"heading","depth":3,"position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"children":[{"type":"text","value":"8.4 Fixed-lag Smoothing and Filtering","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"key":"fIhBfovDlr"}],"identifier":"id-8-4-fixed-lag-smoothing-and-filtering","label":"8.4 Fixed-lag Smoothing and Filtering","html_id":"id-8-4-fixed-lag-smoothing-and-filtering","implicit":true,"key":"n5LScTjB4d"},{"type":"paragraph","position":{"start":{"line":710,"column":1},"end":{"line":710,"column":1}},"children":[{"type":"text","value":"GTSAM can easily perform recursive estimation, where only a subset of the poses are kept in the factor graph, while the remaining poses are marginalized out. In all examples above we explicitly optimize for all variables using all available measurements, which is called Smoothing because the trajectory is “smoothed” out, and this is where GTSAM got its name (GT Smoothing and Mapping). When instead only the last few poses are kept in the graph, one speaks of Fixed-lag Smoothing. Finally, when only the single most recent poses is kept, one speaks of Filtering, and indeed the original formulation of SLAM was filter-based (","position":{"start":{"line":710,"column":1},"end":{"line":710,"column":1}},"key":"Qshm3A9m6a"},{"type":"cite","kind":"narrative","label":"Smith1988","identifier":"smith1988","children":[{"type":"text","value":"Smith & Cheeseman (1988)","key":"IONpeZt0Kg"}],"enumerator":"12","key":"HC2uGb1Gzr"},{"type":"text","value":").","position":{"start":{"line":710,"column":1},"end":{"line":710,"column":1}},"key":"AfzrwRL1ms"}],"key":"FXw8WQuEX3"},{"type":"heading","depth":3,"position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"children":[{"type":"text","value":"8.5 Discrete Variables and HMMs","position":{"start":{"line":712,"column":1},"end":{"line":712,"column":1}},"key":"XDJ7owVgMx"}],"identifier":"id-8-5-discrete-variables-and-hmms","label":"8.5 Discrete Variables and HMMs","html_id":"id-8-5-discrete-variables-and-hmms","implicit":true,"key":"XuIH7XZpD0"},{"type":"paragraph","position":{"start":{"line":714,"column":1},"end":{"line":714,"column":1}},"children":[{"type":"text","value":"Finally, factor graphs are not limited to continuous variables: GTSAM can also be used to model and solve discrete optimization problems. For example, a Hidden Markov Model (HMM) has the same graphical model structure as the Robot Localization problem from Section 2, except that in an HMM the variables are discrete. GTSAM can optimize and perform inference for discrete models.","position":{"start":{"line":714,"column":1},"end":{"line":714,"column":1}},"key":"h7njNZNuob"}],"key":"vMUA3nkw9e"},{"type":"heading","depth":2,"position":{"start":{"line":716,"column":1},"end":{"line":716,"column":1}},"children":[{"type":"text","value":"Acknowledgements","position":{"start":{"line":716,"column":1},"end":{"line":716,"column":1}},"key":"TCelLjyfrN"}],"identifier":"acknowledgements","label":"Acknowledgements","html_id":"acknowledgements","implicit":true,"key":"fUH1l5U9Gq"},{"type":"paragraph","position":{"start":{"line":717,"column":1},"end":{"line":717,"column":1}},"children":[{"type":"text","value":"GTSAM was made possible by the efforts of many collaborators at Georgia Tech and elsewhere, including but not limited to Doru Balcan, Chris Beall, Alex Cunningham, Alireza Fathi, Eohan George, Viorela Ila, Yong-Dian Jian, Michael Kaess, Kai Ni, Carlos Nieto, Duy-Nguyen Ta, Manohar Paluri, Christian Potthast, Richard Roberts, Grant Schindler, and Stephen Williams. In addition, Paritosh Mohan helped me with the manual. Many thanks all for your hard work!","position":{"start":{"line":717,"column":1},"end":{"line":717,"column":1}},"key":"vDoGweJZbs"}],"key":"ZmopeDrG0h"},{"type":"bibliography","filter":"docname in docnames","key":"yjjDHCncIu"},{"type":"footnoteDefinition","identifier":"1","label":"1","position":{"start":{"line":720,"column":1},"end":{"line":720,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"children":[{"type":"text","value":"GTSAM also allows you to wrap your own custom-made classes, although this is out of the scope of this manual. The following code excerpt is the MATLAB equivalent of the C++ code in Listing 4.1:","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"LcxzPd4k1B"}],"key":"RZ9uP03SKP"}],"enumerator":"1","key":"t0p6WkfYir"},{"type":"footnoteDefinition","identifier":"2","label":"2","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"children":[{"type":"text","value":"a 32 or 64 bit integer, depending on your platform","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"ZQQ2Qs1Ows"}],"key":"ui4ITR5s8C"}],"enumerator":"2","key":"WhcUZ2gtCn"}],"key":"rXxtXt74H4"}],"key":"ziUY1vboSX"},"references":{"cite":{"order":["Kschischang2001","Loeliger2004","Dellaert1999","KaessDellaert2009","DurrantWhyteBailey2006","Kaess2008","Kaess2012","Dellaert2010","Jian2011","Nister2004","Davison2003","Smith1988"],"data":{"Kschischang2001":{"label":"Kschischang2001","enumerator":"1","html":"Kschischang, & Loeliger, H.-A. (2001). Factor Graphs and the Sum-Product Algorithm. <i>IEEE Trans. Inform. Theory</i>, <i>47</i>(2)."},"Loeliger2004":{"label":"Loeliger2004","enumerator":"2","html":"Loeliger, H.-A. (2004). An Introduction to Factor Graphs. <i>IEEE Signal Processing Magazine</i>, 28–41."},"Dellaert1999":{"label":"Dellaert1999","enumerator":"3","html":"Dellaert, & Thrun, S. (1999). Using the Condensation Algorithm for Robust, Vision-based Mobile Robot Localization. <i>IEEE Conf. on Computer Vision and Pattern Recognition (CVPR)</i>."},"KaessDellaert2009":{"label":"KaessDellaert2009","enumerator":"4","html":"Kaess, M., & Dellaert, F. (2009). Covariance Recovery from a Square Root Information Matrix for Data Association. <i>Robotics and Autonomous Systems</i>."},"DurrantWhyteBailey2006":{"label":"DurrantWhyteBailey2006","enumerator":"5","html":"Durrant-Whyte, H. F., & Bailey, T. (2006). Simultaneous Localisation and Mapping (SLAM): Part I The Essential Algorithms. <i>Robotics & Automation Magazine</i>."},"Kaess2008":{"label":"Kaess2008","enumerator":"6","html":"Kaess, & Dellaert, F. (2008). iSAM: Incremental Smoothing and Mapping. <i>IEEE Trans. Robotics</i>, <i>24</i>(6), 1365–1378."},"Kaess2012":{"label":"Kaess2012","enumerator":"7","html":"Kaess, & Dellaert, F. (2012). iSAM2: Incremental Smoothing and Mapping Using the Bayes Tree. <i>Intl. J. of Robotics Research</i>, <i>31</i>, 217–236."},"Dellaert2010":{"label":"Dellaert2010","enumerator":"8","html":"Dellaert, & Thorpe, C. E. (2010). Subgraph-preconditioned Conjugate Gradient for Large Scale SLAM. <i>IEEE/RSJ Intl. Conf. on Intelligent Robots and Systems (IROS)</i>."},"Jian2011":{"label":"Jian2011","enumerator":"9","html":"Jian, & Dellaert, F. (2011). Generalized Subgraph Preconditioners for Large-Scale Bundle Adjustment. <i>Intl. Conf. on Computer Vision (ICCV)</i>."},"Nister2004":{"label":"Nister2004","enumerator":"10","html":"Nistér, & Bergen, J. (2004). Visual Odometry. <i>IEEE Conf. on Computer Vision and Pattern Recognition (CVPR)</i>, <i>1</i>, 652–659."},"Davison2003":{"label":"Davison2003","enumerator":"11","html":"Davison, A. J. (2003). Real-Time Simultaneous Localisation and Mapping with a Single Camera. <i>Intl. Conf. on Computer Vision (ICCV)</i>, 1403–1410."},"Smith1988":{"label":"Smith1988","enumerator":"12","html":"Smith, & Cheeseman, P. (1988). A Stochastic Map for Uncertain Spatial Relationships. <i>Proc. of the Intl. Symp. of Robotics Research (ISRR)</i>, 467–474."}}}}}