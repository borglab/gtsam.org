{"version":1,"kind":"Article","sha256":"217c17c71f3a0d1445febb5c03944ce3ba836fca69b65d84f51f333394b65d21","slug":"content.mkl-linux","location":"/Content/MKL-linux.md","dependencies":[],"frontmatter":{"title":"Installing MKL on Linux","content_includes_title":false,"github":"https://github.com/borglab/gtsam","edit_url":"https://github.com/borglab/gtsam/blob/docs/ktk-sdk/Content/MKL-linux.md","exports":[{"format":"md","filename":"MKL-linux.md","url":"/MKL-linux-d613197c06b4da149e2c6a46d9de5eda.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Intel has a guide\nfor installing MKL on Linux through APT repositories ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AbAfnHTZ4f"},{"type":"link","url":"https://software.intel.com/en-us/articles/installing-intel-free-libs-and-python-apt-repo","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Lf2mK9PGPG"}],"urlSource":"https://software.intel.com/en-us/articles/installing-intel-free-libs-and-python-apt-repo","key":"cPwdkzIADh"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L6JTfiMfvJ"}],"key":"bXsLbkrZqT"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"After following the instructions, add the following to your ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ETySPxZIbC"},{"type":"inlineCode","value":"~/.bashrc","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"J4WUAS88Zl"},{"type":"text","value":" (and afterwards, open a new terminal before compiling GTSAM):\n","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BsRJMrVxXb"},{"type":"inlineCode","value":"LD_PRELOAD","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bE5TisyabB"},{"type":"text","value":"\nneed only be set if you are building the cython wrapper to use GTSAM from python.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KouqkgPioP"}],"key":"Au3oIfTC82"},{"type":"code","lang":"sh","value":"source /opt/intel/mkl/bin/mklvars.sh intel64\nexport LD_PRELOAD=\"$LD_PRELOAD:/opt/intel/mkl/lib/intel64/libmkl_core.so:/opt/intel/mkl/lib/intel64/libmkl_sequential.so\"","position":{"start":{"line":10,"column":1},"end":{"line":13,"column":1}},"key":"ZyE9Cpntvz"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"To use MKL in GTSAM pass the flag ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"NQLyRafGCf"},{"type":"inlineCode","value":"-DGTSAM_WITH_EIGEN_MKL=ON","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"a3LZDVxqKI"},{"type":"text","value":" to cmake.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rGtVzNqAjX"}],"key":"j9xPHci8Zw"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"KaWKQybha4"},{"type":"inlineCode","value":"LD_PRELOAD","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"v2BhArcFnA"},{"type":"text","value":" fix seems to be related to a well known problem with MKL which leads to lots of undefined symbol errors, for example:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ngGTrPHlaj"}],"key":"WqMhjzr8zt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"link","url":"https://software.intel.com/en-us/forums/intel-math-kernel-library/topic/300857","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"https://​software​.intel​.com​/en​-us​/forums​/intel​-math​-kernel​-library​/topic​/300857","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"JoPvdUbQVN"}],"urlSource":"https://software.intel.com/en-us/forums/intel-math-kernel-library/topic/300857","key":"RGZHOjXfX6"}],"key":"dB3dJRw4BI"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"link","url":"https://software.intel.com/en-us/forums/intel-distribution-for-python/topic/628976","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"https://​software​.intel​.com​/en​-us​/forums​/intel​-distribution​-for​-python​/topic​/628976","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"uXF3Ck05T1"}],"urlSource":"https://software.intel.com/en-us/forums/intel-distribution-for-python/topic/628976","key":"UhQjIj41Ft"}],"key":"m7qwjVd7PX"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"link","url":"https://groups.google.com/a/continuum.io/forum/#!topic/anaconda/J3YGoef64z8","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"https://​groups​.google​.com​/a​/continuum​.io​/forum​/​#!topic​/anaconda​/J3YGoef64z8","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"nixTocIJOS"}],"urlSource":"https://groups.google.com/a/continuum.io/forum/#!topic/anaconda/J3YGoef64z8","key":"L2M837YhgN"}],"key":"d4mTYG0xqT"}],"key":"qBabyJ7Kyf"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Failing to specify ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"orvlUZbrUy"},{"type":"inlineCode","value":"LD_PRELOAD","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"aamS9vft0s"},{"type":"text","value":" may lead to errors such as:","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"vRKZifK6dk"}],"key":"DiXAecgVvL"},{"type":"code","lang":"","value":"ImportError: /opt/intel/mkl/lib/intel64/libmkl_vml_avx2.so: undefined symbol: mkl_serv_getenv","position":{"start":{"line":25,"column":1},"end":{"line":27,"column":1}},"key":"MqymckDeDy"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"or","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"oJltDiaVB6"}],"key":"eDmrhip1Xu"},{"type":"code","lang":"","value":"Intel MKL FATAL ERROR: Cannot load libmkl_avx2.so or libmkl_def.so.","position":{"start":{"line":31,"column":1},"end":{"line":33,"column":1}},"key":"JpeCwi2q22"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"when importing GTSAM using the cython wrapper in python.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"NuG3SEYdJH"}],"key":"v0ma1ioDVc"}],"key":"hcs60ZjU2K"}],"key":"f63Dj38WP6"},"references":{"cite":{"order":[],"data":{}}}}